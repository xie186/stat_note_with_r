<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Notes of R for Bioinformatics</title>
  <meta name="description" content="Notes of R for Bioinformatics">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Notes of R for Bioinformatics" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Notes of R for Bioinformatics" />
  
  
  

<meta name="author" content="Shaojun Xie">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="introduction-of-r.html">
<link rel="next" href="correlation.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="introduction-of-r.html"><a href="introduction-of-r.html"><i class="fa fa-check"></i><b>1</b> Introduction of R</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction-of-r.html"><a href="introduction-of-r.html#setup"><i class="fa fa-check"></i><b>1.1</b> Setup</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-of-r.html"><a href="introduction-of-r.html#basic-systax"><i class="fa fa-check"></i><b>1.2</b> Basic systax</a><ul>
<li class="chapter" data-level="1.2.1" data-path="introduction-of-r.html"><a href="introduction-of-r.html#install-packages"><i class="fa fa-check"></i><b>1.2.1</b> Install packages</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction-of-r.html"><a href="introduction-of-r.html#install"><i class="fa fa-check"></i><b>1.2.2</b> Install</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction-of-r.html"><a href="introduction-of-r.html#data-type"><i class="fa fa-check"></i><b>1.3</b> Data type</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-of-r.html"><a href="introduction-of-r.html#data-structures"><i class="fa fa-check"></i><b>1.4</b> Data structures</a></li>
<li class="chapter" data-level="1.5" data-path="introduction-of-r.html"><a href="introduction-of-r.html#read-from-and-write-into-files"><i class="fa fa-check"></i><b>1.5</b> Read from and write into files</a><ul>
<li class="chapter" data-level="1.5.1" data-path="introduction-of-r.html"><a href="introduction-of-r.html#read-random-rows-from-a-huge-file"><i class="fa fa-check"></i><b>1.5.1</b> Read Random Rows from A Huge File</a></li>
<li class="chapter" data-level="1.5.2" data-path="introduction-of-r.html"><a href="introduction-of-r.html#reference"><i class="fa fa-check"></i><b>1.5.2</b> Reference</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="introduction-of-r.html"><a href="introduction-of-r.html#functions"><i class="fa fa-check"></i><b>1.6</b> Functions</a></li>
<li class="chapter" data-level="1.7" data-path="introduction-of-r.html"><a href="introduction-of-r.html#control-structure"><i class="fa fa-check"></i><b>1.7</b> Control structure</a></li>
<li class="chapter" data-level="1.8" data-path="introduction-of-r.html"><a href="introduction-of-r.html#reference-1"><i class="fa fa-check"></i><b>1.8</b> Reference</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="plot-in-r.html"><a href="plot-in-r.html"><i class="fa fa-check"></i><b>2</b> Plot in R</a><ul>
<li class="chapter" data-level="2.1" data-path="plot-in-r.html"><a href="plot-in-r.html#read-the-data"><i class="fa fa-check"></i><b>2.1</b> Read the data</a></li>
<li class="chapter" data-level="2.2" data-path="plot-in-r.html"><a href="plot-in-r.html#line-plot"><i class="fa fa-check"></i><b>2.2</b> Line plot</a></li>
<li class="chapter" data-level="2.3" data-path="plot-in-r.html"><a href="plot-in-r.html#basic-line-plot"><i class="fa fa-check"></i><b>2.3</b> Basic line plot</a></li>
<li class="chapter" data-level="2.4" data-path="plot-in-r.html"><a href="plot-in-r.html#color-the-dots-based-on-the-sex-information"><i class="fa fa-check"></i><b>2.4</b> Color the dots based on the <code>sex</code> information</a></li>
<li class="chapter" data-level="2.5" data-path="plot-in-r.html"><a href="plot-in-r.html#section"><i class="fa fa-check"></i><b>2.5</b> </a></li>
<li class="chapter" data-level="2.6" data-path="plot-in-r.html"><a href="plot-in-r.html#draw-a-circle-in-r"><i class="fa fa-check"></i><b>2.6</b> Draw a circle in R</a></li>
<li class="chapter" data-level="2.7" data-path="plot-in-r.html"><a href="plot-in-r.html#network"><i class="fa fa-check"></i><b>2.7</b> Network</a><ul>
<li class="chapter" data-level="2.7.1" data-path="plot-in-r.html"><a href="plot-in-r.html#section-1"><i class="fa fa-check"></i><b>2.7.1</b> </a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="correlation.html"><a href="correlation.html"><i class="fa fa-check"></i><b>3</b> Correlation</a><ul>
<li class="chapter" data-level="3.1" data-path="correlation.html"><a href="correlation.html#visulization-of-pair-wise-correlation-in-r"><i class="fa fa-check"></i><b>3.1</b> Visulization of pair-wise correlation in R</a></li>
<li class="chapter" data-level="3.2" data-path="correlation.html"><a href="correlation.html#correlation-and-p-values-of-all-combinations-of-all-rows-of-two-matrices"><i class="fa fa-check"></i><b>3.2</b> Correlation and p-values of all combinations of all rows of two matrices</a><ul>
<li class="chapter" data-level="3.2.1" data-path="correlation.html"><a href="correlation.html#prepare-the-data"><i class="fa fa-check"></i><b>3.2.1</b> Prepare the data</a></li>
<li class="chapter" data-level="3.2.2" data-path="correlation.html"><a href="correlation.html#another-way-to-do-this-is-to-use-corr.test"><i class="fa fa-check"></i><b>3.2.2</b> Another way to do this is to use <code>corr.test</code></a></li>
<li class="chapter" data-level="3.2.3" data-path="correlation.html"><a href="correlation.html#read-data"><i class="fa fa-check"></i><b>3.2.3</b> Read data</a></li>
<li class="chapter" data-level="3.2.4" data-path="correlation.html"><a href="correlation.html#calculate-the-correlation-advance"><i class="fa fa-check"></i><b>3.2.4</b> Calculate the correlation (Advance)</a></li>
<li class="chapter" data-level="3.2.5" data-path="correlation.html"><a href="correlation.html#reference-3"><i class="fa fa-check"></i><b>3.2.5</b> Reference</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="correlation.html"><a href="correlation.html#different-ways-to-visulize-correlation"><i class="fa fa-check"></i><b>3.3</b> Different ways to visulize correlation</a><ul>
<li class="chapter" data-level="3.3.1" data-path="correlation.html"><a href="correlation.html#display-correlation-using-chart.correlation-in-performanceanalytics"><i class="fa fa-check"></i><b>3.3.1</b> Display correlation using <code>chart.Correlation</code> in <code>PerformanceAnalytics</code></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="correlation.html"><a href="correlation.html#reference-4"><i class="fa fa-check"></i><b>3.4</b> Reference</a></li>
</ul></li>
<li class="part"><span><b>II Statistics</b></span></li>
<li class="chapter" data-level="4" data-path="standard-deviation-vs-standard-error.html"><a href="standard-deviation-vs-standard-error.html"><i class="fa fa-check"></i><b>4</b> Standard deviation vs Standard error</a><ul>
<li class="chapter" data-level="4.1" data-path="standard-deviation-vs-standard-error.html"><a href="standard-deviation-vs-standard-error.html#reference-5"><i class="fa fa-check"></i><b>4.1</b> Reference</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="t-test.html"><a href="t-test.html"><i class="fa fa-check"></i><b>5</b> T test</a><ul>
<li class="chapter" data-level="5.1" data-path="t-test.html"><a href="t-test.html#calculate-t-statistic-step-by-step-in-r"><i class="fa fa-check"></i><b>5.1</b> Calculate t-statistic step by step in R</a><ul>
<li class="chapter" data-level="5.1.1" data-path="t-test.html"><a href="t-test.html#section-2"><i class="fa fa-check"></i><b>5.1.1</b> </a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="t-test.html"><a href="t-test.html#calculate-the-standard-deviation-in-r"><i class="fa fa-check"></i><b>5.2</b> Calculate the standard deviation in R</a></li>
<li class="chapter" data-level="5.3" data-path="t-test.html"><a href="t-test.html#reference-6"><i class="fa fa-check"></i><b>5.3</b> Reference</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="linear-model.html"><a href="linear-model.html"><i class="fa fa-check"></i><b>6</b> Linear model</a><ul>
<li class="chapter" data-level="6.1" data-path="linear-model.html"><a href="linear-model.html#section-3"><i class="fa fa-check"></i><b>6.1</b> </a></li>
<li class="chapter" data-level="6.2" data-path="linear-model.html"><a href="linear-model.html#extract-male-data"><i class="fa fa-check"></i><b>6.2</b> Extract male data</a></li>
<li class="chapter" data-level="6.3" data-path="linear-model.html"><a href="linear-model.html#reference-7"><i class="fa fa-check"></i><b>6.3</b> Reference</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="mrg.html"><a href="mrg.html"><i class="fa fa-check"></i><b>7</b> MRG</a><ul>
<li class="chapter" data-level="7.1" data-path="mrg.html"><a href="mrg.html#read-the-data-1"><i class="fa fa-check"></i><b>7.1</b> Read the data</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html"><i class="fa fa-check"></i><b>8</b> Multiple linear regression</a><ul>
<li class="chapter" data-level="8.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#section-4"><i class="fa fa-check"></i><b>8.1</b> </a></li>
<li class="chapter" data-level="8.2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#section-5"><i class="fa fa-check"></i><b>8.2</b> </a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="bayesian-newwork-in-r.html"><a href="bayesian-newwork-in-r.html"><i class="fa fa-check"></i><b>9</b> Bayesian newwork in R</a><ul>
<li class="chapter" data-level="9.1" data-path="bayesian-newwork-in-r.html"><a href="bayesian-newwork-in-r.html#practical-experiments"><i class="fa fa-check"></i><b>9.1</b> Practical experiments</a><ul>
<li class="chapter" data-level="9.1.1" data-path="bayesian-newwork-in-r.html"><a href="bayesian-newwork-in-r.html#analysis-of-the-magic-population-in-scutari-et-al.-genetics-2014"><i class="fa fa-check"></i><b>9.1.1</b> Analysis of the MAGIC population in Scutari et al., Genetics (2014)</a></li>
<li class="chapter" data-level="9.1.2" data-path="bayesian-newwork-in-r.html"><a href="bayesian-newwork-in-r.html#reference-8"><i class="fa fa-check"></i><b>9.1.2</b> Reference</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="the-rationale-for-using-negative-binomial-distribution-to-model-read-count-in-rna-seq-data.html"><a href="the-rationale-for-using-negative-binomial-distribution-to-model-read-count-in-rna-seq-data.html"><i class="fa fa-check"></i><b>10</b> The rationale for using negative binomial distribution to model read count in RNA-seq data</a><ul>
<li class="chapter" data-level="10.1" data-path="the-rationale-for-using-negative-binomial-distribution-to-model-read-count-in-rna-seq-data.html"><a href="the-rationale-for-using-negative-binomial-distribution-to-model-read-count-in-rna-seq-data.html#negative-binomial-in-r"><i class="fa fa-check"></i><b>10.1</b> Negative binomial in R</a><ul>
<li class="chapter" data-level="10.1.1" data-path="the-rationale-for-using-negative-binomial-distribution-to-model-read-count-in-rna-seq-data.html"><a href="the-rationale-for-using-negative-binomial-distribution-to-model-read-count-in-rna-seq-data.html#real-data"><i class="fa fa-check"></i><b>10.1.1</b> Real data</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="the-rationale-for-using-negative-binomial-distribution-to-model-read-count-in-rna-seq-data.html"><a href="the-rationale-for-using-negative-binomial-distribution-to-model-read-count-in-rna-seq-data.html#reference-9"><i class="fa fa-check"></i><b>10.2</b> Reference</a></li>
<li class="chapter" data-level="10.3" data-path="the-rationale-for-using-negative-binomial-distribution-to-model-read-count-in-rna-seq-data.html"><a href="the-rationale-for-using-negative-binomial-distribution-to-model-read-count-in-rna-seq-data.html#batch-effect"><i class="fa fa-check"></i><b>10.3</b> Batch effect</a></li>
<li class="chapter" data-level="10.4" data-path="the-rationale-for-using-negative-binomial-distribution-to-model-read-count-in-rna-seq-data.html"><a href="the-rationale-for-using-negative-binomial-distribution-to-model-read-count-in-rna-seq-data.html#reference-10"><i class="fa fa-check"></i><b>10.4</b> Reference</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="multiple-test-corretion.html"><a href="multiple-test-corretion.html"><i class="fa fa-check"></i><b>11</b> Multiple test corretion</a></li>
<li class="chapter" data-level="12" data-path="working-with-missing-values.html"><a href="working-with-missing-values.html"><i class="fa fa-check"></i><b>12</b> Working with missing values</a><ul>
<li class="chapter" data-level="12.1" data-path="working-with-missing-values.html"><a href="working-with-missing-values.html#section-6"><i class="fa fa-check"></i><b>12.1</b> </a></li>
<li class="chapter" data-level="12.2" data-path="working-with-missing-values.html"><a href="working-with-missing-values.html#summaryize-the-missing-values"><i class="fa fa-check"></i><b>12.2</b> Summaryize the missing values</a><ul>
<li class="chapter" data-level="12.2.1" data-path="working-with-missing-values.html"><a href="working-with-missing-values.html#summarize-the-missing-values-using-mice-package"><i class="fa fa-check"></i><b>12.2.1</b> Summarize the missing values using <code>mice</code> package</a></li>
<li class="chapter" data-level="12.2.2" data-path="working-with-missing-values.html"><a href="working-with-missing-values.html#summarize-the-missing-values-using-vim-packages"><i class="fa fa-check"></i><b>12.2.2</b> Summarize the missing values using <code>VIM</code> packages</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="working-with-missing-values.html"><a href="working-with-missing-values.html#delete-columnsrows-with-more-that-x-missing"><i class="fa fa-check"></i><b>12.3</b> Delete columns/rows with more that x% missing</a></li>
<li class="chapter" data-level="12.4" data-path="working-with-missing-values.html"><a href="working-with-missing-values.html#imputing-the-data"><i class="fa fa-check"></i><b>12.4</b> Imputing the data</a><ul>
<li class="chapter" data-level="12.4.1" data-path="working-with-missing-values.html"><a href="working-with-missing-values.html#imputing-the-data-with-row-wise-mean"><i class="fa fa-check"></i><b>12.4.1</b> Imputing the data with row-wise mean</a></li>
<li class="chapter" data-level="12.4.2" data-path="working-with-missing-values.html"><a href="working-with-missing-values.html#imputing-the-data-with-row-wise-mean-using-mice"><i class="fa fa-check"></i><b>12.4.2</b> Imputing the data with row-wise mean using <code>mice</code></a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="working-with-missing-values.html"><a href="working-with-missing-values.html#reference-11"><i class="fa fa-check"></i><b>12.5</b> Reference</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>13</b> Data wrangling</a><ul>
<li class="chapter" data-level="13.1" data-path="data-wrangling.html"><a href="data-wrangling.html#section-7"><i class="fa fa-check"></i><b>13.1</b> </a></li>
<li class="chapter" data-level="13.2" data-path="data-wrangling.html"><a href="data-wrangling.html#joining-data-in-r-with-dplyr"><i class="fa fa-check"></i><b>13.2</b> Joining Data in R with dplyr</a><ul>
<li class="chapter" data-level="13.2.1" data-path="data-wrangling.html"><a href="data-wrangling.html#whats-covered"><i class="fa fa-check"></i><b>13.2.1</b> Whats Covered</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="data-wrangling.html"><a href="data-wrangling.html#reference-12"><i class="fa fa-check"></i><b>13.3</b> Reference</a></li>
</ul></li>
<li class="part"><span><b>III Machine learning</b></span></li>
<li class="chapter" data-level="14" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>14</b> PCA</a><ul>
<li class="chapter" data-level="14.1" data-path="pca.html"><a href="pca.html#read-data-1"><i class="fa fa-check"></i><b>14.1</b> Read data</a></li>
<li class="chapter" data-level="14.2" data-path="pca.html"><a href="pca.html#head-data"><i class="fa fa-check"></i><b>14.2</b> Head data</a></li>
<li class="chapter" data-level="14.3" data-path="pca.html"><a href="pca.html#summary-of-the-data"><i class="fa fa-check"></i><b>14.3</b> Summary of the data</a></li>
<li class="chapter" data-level="14.4" data-path="pca.html"><a href="pca.html#check-the-distribution-of-the-data"><i class="fa fa-check"></i><b>14.4</b> Check the distribution of the data</a></li>
<li class="chapter" data-level="14.5" data-path="pca.html"><a href="pca.html#eigendecomposition---computing-eigenvectors-and-eigenvalues"><i class="fa fa-check"></i><b>14.5</b> Eigendecomposition - Computing Eigenvectors and Eigenvalues</a><ul>
<li class="chapter" data-level="14.5.1" data-path="pca.html"><a href="pca.html#covariance-matrix"><i class="fa fa-check"></i><b>14.5.1</b> Covariance Matrix</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="pca.html"><a href="pca.html#pca-with-two-variables"><i class="fa fa-check"></i><b>14.6</b> PCA with two variables</a></li>
<li class="chapter" data-level="14.7" data-path="pca.html"><a href="pca.html#pca-on-wine-data"><i class="fa fa-check"></i><b>14.7</b> PCA on <code>wine</code> data</a><ul>
<li class="chapter" data-level="14.7.1" data-path="pca.html"><a href="pca.html#read-the-wine-data"><i class="fa fa-check"></i><b>14.7.1</b> Read the <code>wine</code> data</a></li>
<li class="chapter" data-level="14.7.2" data-path="pca.html"><a href="pca.html#description-of-each-column"><i class="fa fa-check"></i><b>14.7.2</b> Description of each column</a></li>
<li class="chapter" data-level="14.7.3" data-path="pca.html"><a href="pca.html#example"><i class="fa fa-check"></i><b>14.7.3</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="pca.html"><a href="pca.html#references"><i class="fa fa-check"></i><b>14.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="random-forest.html"><a href="random-forest.html"><i class="fa fa-check"></i><b>15</b> Random forest</a><ul>
<li class="chapter" data-level="15.1" data-path="random-forest.html"><a href="random-forest.html#practical-experiments-1"><i class="fa fa-check"></i><b>15.1</b> Practical experiments</a><ul>
<li class="chapter" data-level="15.1.1" data-path="random-forest.html"><a href="random-forest.html#random-forest-for-prediction-of-iris"><i class="fa fa-check"></i><b>15.1.1</b> Random forest for prediction of iris</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="qtl-analysis.html"><a href="qtl-analysis.html"><i class="fa fa-check"></i><b>16</b> QTL analysis</a><ul>
<li class="chapter" data-level="16.1" data-path="qtl-analysis.html"><a href="qtl-analysis.html#reference-13"><i class="fa fa-check"></i><b>16.1</b> Reference</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="17" data-path="transformation-of-data.html"><a href="transformation-of-data.html"><i class="fa fa-check"></i><b>17</b> Transformation of data</a><ul>
<li class="chapter" data-level="17.1" data-path="transformation-of-data.html"><a href="transformation-of-data.html#log-transformation"><i class="fa fa-check"></i><b>17.1</b> Log transformation</a><ul>
<li class="chapter" data-level="17.1.1" data-path="transformation-of-data.html"><a href="transformation-of-data.html#the-rationale-of-using-log2-transformation"><i class="fa fa-check"></i><b>17.1.1</b> The rationale of using log2 transformation</a></li>
<li class="chapter" data-level="17.1.2" data-path="transformation-of-data.html"><a href="transformation-of-data.html#reference-14"><i class="fa fa-check"></i><b>17.1.2</b> Reference</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="partial-least-square-analysis.html"><a href="partial-least-square-analysis.html"><i class="fa fa-check"></i><b>18</b> Partial least square analysis</a><ul>
<li class="chapter" data-level="18.1" data-path="partial-least-square-analysis.html"><a href="partial-least-square-analysis.html#prepare-the-data-1"><i class="fa fa-check"></i><b>18.1</b> Prepare the data</a></li>
<li class="chapter" data-level="18.2" data-path="partial-least-square-analysis.html"><a href="partial-least-square-analysis.html#principal-component-analysis-pca"><i class="fa fa-check"></i><b>18.2</b> Principal Component Analysis (PCA)</a></li>
<li class="chapter" data-level="18.3" data-path="partial-least-square-analysis.html"><a href="partial-least-square-analysis.html#partial-least-squares-pls-and-pls-da"><i class="fa fa-check"></i><b>18.3</b> Partial least-squares: PLS and PLS-DA</a></li>
<li class="chapter" data-level="18.4" data-path="partial-least-square-analysis.html"><a href="partial-least-square-analysis.html#reference-15"><i class="fa fa-check"></i><b>18.4</b> Reference</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="scale.html"><a href="scale.html"><i class="fa fa-check"></i><b>19</b> Scale</a><ul>
<li class="chapter" data-level="19.1" data-path="scale.html"><a href="scale.html#reference-16"><i class="fa fa-check"></i><b>19.1</b> Reference</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="web-scraping.html"><a href="web-scraping.html"><i class="fa fa-check"></i><b>20</b> Web scraping</a><ul>
<li class="chapter" data-level="20.1" data-path="web-scraping.html"><a href="web-scraping.html#download-content-from-ncbi-databases-using-rismed"><i class="fa fa-check"></i><b>20.1</b> Download Content from NCBI Databases using <code>RISmed</code></a><ul>
<li class="chapter" data-level="20.1.1" data-path="web-scraping.html"><a href="web-scraping.html#search-author-name"><i class="fa fa-check"></i><b>20.1.1</b> Search author name</a></li>
<li class="chapter" data-level="20.1.2" data-path="web-scraping.html"><a href="web-scraping.html#search-keyword"><i class="fa fa-check"></i><b>20.1.2</b> Search keyword</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes of R for Bioinformatics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plot-in-r" class="section level1">
<h1><span class="header-section-number">2</span> Plot in R</h1>
<div id="read-the-data" class="section level2">
<h2><span class="header-section-number">2.1</span> Read the data</h2>
<p>Consider the data collected by Francis Galton in the 1880s, stored in a modern format in the <code>galton.csv</code> file. In this file, <code>heights</code> is the variable containing the child’s heights, while the <code>father</code>’s and <code>mother</code>’s height is contained in the variables father and mother. The family variable is a numerical code identifying children in the same family; the number of kids in this family is in <code>nkids</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Data from  https://github.com/thomas-haslwanter/statsintro_python/blob/master/ISP/Code_Quantlets/08_TestsMeanValues/anovaOneway/galton.csv
tab&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;data/galton.csv&quot;</span>)
<span class="kw">head</span>(tab)</code></pre></div>
<pre><code>##   family father mother sex height nkids
## 1      1   78.5   67.0   M   73.2     4
## 2      1   78.5   67.0   F   69.2     4
## 3      1   78.5   67.0   F   69.0     4
## 4      1   78.5   67.0   F   69.0     4
## 5      2   75.5   66.5   M   73.5     4
## 6      2   75.5   66.5   M   72.5     4</code></pre>
</div>
<div id="line-plot" class="section level2">
<h2><span class="header-section-number">2.2</span> Line plot</h2>
</div>
<div id="basic-line-plot" class="section level2">
<h2><span class="header-section-number">2.3</span> Basic line plot</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(tab<span class="op">$</span>father, tab<span class="op">$</span>height)</code></pre></div>
<p><img src="bioinfBookXIE186_files/figure-html/unnamed-chunk-5-1.png" width="576" /></p>
</div>
<div id="color-the-dots-based-on-the-sex-information" class="section level2">
<h2><span class="header-section-number">2.4</span> Color the dots based on the <code>sex</code> information</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">col_info =<span class="st"> </span><span class="kw">ifelse</span>(tab<span class="op">$</span>sex<span class="op">==</span><span class="st">&quot;M&quot;</span>, <span class="st">&quot;royalblue&quot;</span>, <span class="st">&quot;darkred&quot;</span>)
<span class="kw">plot</span>(tab<span class="op">$</span>father, tab<span class="op">$</span>height, <span class="dt">col=</span>col_info)</code></pre></div>
<p><img src="bioinfBookXIE186_files/figure-html/unnamed-chunk-6-1.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">col_info =<span class="st"> </span><span class="kw">ifelse</span>(tab<span class="op">$</span>sex<span class="op">==</span><span class="st">&quot;M&quot;</span>, <span class="st">&quot;royalblue&quot;</span>, <span class="st">&quot;darkred&quot;</span>)
<span class="kw">plot</span>(tab<span class="op">$</span>father, tab<span class="op">$</span>height, <span class="dt">col=</span>col_info, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">60</span>, <span class="dv">80</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">60</span>, <span class="dv">80</span>))
<span class="kw">legend</span>(<span class="dv">76</span>, <span class="dv">65</span>,<span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">19</span>,<span class="dv">19</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;royalblue&quot;</span>, <span class="st">&quot;darkred&quot;</span>),<span class="kw">c</span>(<span class="st">&quot;female&quot;</span>, <span class="st">&quot;male&quot;</span>),<span class="dt">bty=</span><span class="st">&quot;o&quot;</span>,<span class="dt">cex=</span>.<span class="dv">8</span>)</code></pre></div>
<p><img src="bioinfBookXIE186_files/figure-html/unnamed-chunk-7-1.png" width="576" /></p>
</div>
<div id="section" class="section level2">
<h2><span class="header-section-number">2.5</span> </h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">meth_lev=<span class="kw">read.table</span>(<span class="st">&quot;data/global_meth_lev.tsv&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>)
meth_lev</code></pre></div>
<pre><code>##       Sample    CG   CHG   CHH
## 1      cmt23 0.227 0.009 0.011
## 2     cmt2-3 0.229 0.062 0.010
## 3 drm12cmt23 0.221 0.004 0.005
## 4  drm12cmt2 0.222 0.059 0.005
## 5         WT 0.247 0.079 0.029</code></pre>
</div>
<div id="draw-a-circle-in-r" class="section level2">
<h2><span class="header-section-number">2.6</span> Draw a circle in R</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># initialize a plot</span>
<span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)

<span class="co"># prepare &quot;circle data&quot;</span>
radius &lt;-<span class="st"> </span><span class="dv">1</span>
theta &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi, <span class="dt">length =</span> <span class="dv">200</span>)

<span class="co"># draw the circle</span>
<span class="kw">lines</span>(<span class="dt">x =</span> radius <span class="op">*</span><span class="st"> </span><span class="kw">cos</span>(theta), <span class="dt">y =</span> radius <span class="op">*</span><span class="st"> </span><span class="kw">sin</span>(theta))</code></pre></div>
<p><img src="bioinfBookXIE186_files/figure-html/unnamed-chunk-9-1.png" width="576" /></p>
</div>
<div id="network" class="section level2">
<h2><span class="header-section-number">2.7</span> Network</h2>
<div id="section-1" class="section level3">
<h3><span class="header-section-number">2.7.1</span> </h3>
<pre><code>
##========================================================##
##                                                        ##
##   Network Visualization with R                         ##
##   Polnet 2018 Workshop, Washington, DC                 ##
##   www.kateto.net/polnet2018                            ##
##                                                        ##
##   Katherine (Katya) Ognyanova                          ##
##   Web: kateto.net | Email: katya@ognyanova.net         ##
##   GitHub: kateto  | Twitter: @Ognyanova                ##
##                                                        ##
##========================================================##



# ================ Introduction ================ 


# Download handouts and example data: bit.ly/polnet2018
# Online tutorial: kateto.net/polnet2018


# CONTENTS
#
#   1. Working with colors in R plots
#   2. Reading in the network data
#   3. Network plots in &#39;igraph&#39;
#   4. Plotting two-mode networks
#   5. Plotting multiplex networks
#   6. Quick example using &#39;network&#39; 
#   7. Simple plot animations in R
#   8. Interactive JavaScript networks 
#   9. Interactive and dynamic networks with ndtv-d3
#  10. Plotting networks on a geographic map


# KEY PACKAGES
# Install those now if you do not have the latest versions. 
# (please do NOT load them yet!)

install.packages(&quot;igraph&quot;) 
install.packages(&quot;network&quot;) 
install.packages(&quot;sna&quot;)
install.packages(&quot;visNetwork&quot;)
install.packages(&quot;threejs&quot;)
install.packages(&quot;ndtv&quot;)


# OPTIONAL PACKAGES
# Install those if you would like to run through all of the
# examples below (those are not critical and can be skipped).

install.packages(&quot;RColorBrewer&quot;) 
install.packages(&quot;png&quot;)
install.packages(&quot;networkD3&quot;)
install.packages(&quot;animation&quot;)
install.packages(&quot;maps&quot;)
install.packages(&quot;geosphere&quot;)
 



# ================ 1. Colors in R plots ================ 
 

#  -------~~ Colors --------


# In most R functions, you can use named colors, hex, or rgb values:

plot(x=1:10, y=rep(5,10), pch=19, cex=5, col=&quot;dark red&quot;)
points(x=1:10, y=rep(6, 10), pch=19, cex=5, col=&quot;#557799&quot;)
points(x=1:10, y=rep(4, 10), pch=19, cex=5, col=rgb(.25, .5, .3))

# In the simple base plot chart above, x and y are point coordinates, &#39;pch&#39; 
# is the point symbol shape, &#39;cex&#39; is the point size, and &#39;col&#39; is the color.

# To see the parameters for plotting in base R, check out ?par
# Some key ones include &quot;bg&quot; for background color, &#39;cex&#39; for scaling text size,
# &#39;mar&#39; for plot margins, &#39;new&#39; for plotting witout clearing the previous plot,
# &#39;mfcol&#39; &amp; &#39;mfrow&#39; split plotting space into rows and columns for multiple plots
?par

# To close the current graphics device clearing the plot and plot parameters, use: 
dev.off()

# If you plan on using the built-in color names, here&#39;s what they are: 
colors() # all colors
grep(&quot;blue&quot;, colors(), value=T) # colors that have &#39;blue&#39; in the name

# You may notice that rgb here ranges from 0 to 1. While this is the R default,
# you can also set it for the more typical 0-255 range: 
rgb(10, 100, 100, maxColorValue=255) 


#  -------~~ Transparency --------

# We can also set the opacity/transparency using the parameter &#39;alpha&#39; (range 0-1):
plot(x=1:5, y=rep(5,5), pch=19, cex=16, col=rgb(.25, .5, .3, alpha=.5), xlim=c(0,6))  

# If we have a hex color representation, we can set the transparency alpha 
# using &#39;adjustcolor&#39; from package &#39;grDevices&#39;. For fun, let&#39;s also set the
# the plot background to black using the par() function for graphical parameters.
# We could also set the margins in par() with mar=c(bottom, left, top, right).
par(bg=&quot;black&quot;)

col.tr &lt;- grDevices::adjustcolor(&quot;#557799&quot;, alpha=0.7)
plot(x=1:5, y=rep(5,5), pch=19, cex=20, col=col.tr, xlim=c(0,6)) 

dev.off()


#  -------~~ Palettes --------

# In many cases, we need a number of contrasting colors, or multiple shades of a color.
# R comes with some predefined palette function that can generate those for us.
pal1 &lt;- heat.colors(5, alpha=1)   # generate 5 colors from the heat palette, opaque
pal2 &lt;- rainbow(5, alpha=.5)      # generate 5 colors from the heat palette, semi-transparent
plot(x=1:10, y=1:10, pch=19, cex=10, col=pal1)
par(new=TRUE) # tells R not to clear the first plot before adding the second one
plot(x=10:1, y=1:10, pch=19, cex=10, col=pal2)

# We can also generate our own gradients using colorRampPalette().
# Note that colorRampPalette returns a FUNCTION that we can use 
# to generate as many colors from that palette as we need.

palf &lt;- colorRampPalette(c(&quot;gray70&quot;, &quot;dark red&quot;, &quot;orange&quot;)) 
plot(x=10:1, y=1:10, pch=19, cex=10, col=palf(10)) 

# To add transparency to colorRampPalette, you need to add a parameter `alpha=TRUE`:
palf &lt;- colorRampPalette(c(rgb(1,1,1, .2),rgb(.8,0,0, .7)), alpha=TRUE)
plot(x=10:1, y=1:10, pch=19, cex=10, col=palf(10)) 


#  -------~~ ColorBrewer --------

# Finding good color combinations is a tough task - and the built-in R palettes
# are rather limited. Thankfully there are other available packages for this:

# install.packages(&quot;RColorBrewer&quot;)
library(&quot;RColorBrewer&quot;)

display.brewer.all()

# This package has one main function, called &#39;brewer.pal&#39;.
# Using it, you just need to select the desired palette and a number of colors.
# Let&#39;s take a look at some of the RColorBrewer palettes:
display.brewer.pal(8, &quot;Set3&quot;)
display.brewer.pal(8, &quot;Spectral&quot;)
display.brewer.pal(8, &quot;Blues&quot;)


# Plot figures using ColorBrewer
# We&#39;ll use par() to plot multiple figures.
# plot row by row: mfrow=c(number of rows, number of columns)
# plot column by column: mfcol=c(number of rows, number of columns)

par(mfrow=c(1,2)) # plot two figures - 1 row, 2 columns

pal3 &lt;- brewer.pal(10, &quot;Set3&quot;)
plot(x=10:1, y=10:1, pch=19, cex=6, col=pal3)
plot(x=10:1, y=10:1, pch=19, cex=6, col=rev(pal3)) # backwards

dev.off() # shut off the  graphic device to clear the two-figure configuration.


detach(&quot;package:RColorBrewer&quot;)



# ================ 2. Reading network data into &#39;igraph&#39; ================


# Download an archive with the data files from http://bit.ly/polnet2018  

# Clear your workspace by removing all objects returned by ls():
rm(list = ls()) 
 
# Set the working directory to the folder containing the workshop files:
setwd(&quot;C:/polnet2018&quot;) 

# If you don&#39;t know the path to the folder and you&#39;re in RStudio, go to the
# &quot;Session&quot; menu -&gt; &quot;Set Working Directory&quot; -&gt; &quot;To Source File Location&quot;


library(&quot;igraph&quot;)


# -------~~ DATASET 1: edgelist  --------
 
# Read in the data:
nodes &lt;- read.csv(&quot;./Data files/Dataset1-Media-Example-NODES.csv&quot;, header=T, as.is=T)
links &lt;- read.csv(&quot;./Data files/Dataset1-Media-Example-EDGES.csv&quot;, header=T, as.is=T)

# Examine the data:
head(nodes)
head(links)

# Converting the data to an igraph object:
# The graph_from_data_frame() function takes two data frames: &#39;d&#39; and &#39;vertices&#39;.
# &#39;d&#39; describes the edges of the network - it should start with two columns 
# containing the source and target node IDs for each network tie.
# &#39;vertices&#39; should start with a column of node IDs. It can be omitted.
# Any additional columns in either data frame are interpreted as attributes.

net &lt;- graph_from_data_frame(d=links, vertices=nodes, directed=T) 

# Examine the resulting object:
class(net)
net 

# The description of an igraph object starts with four letters:
#     D or U, for a directed or undirected graph
#     N for a named graph (where nodes have a `name` attribute)
#     W for a weighted graph (where edges have a `weight` attribute)
#     B for a bipartite (two-mode) graph (where nodes have a `type` attribute)
# The two numbers that follow (17 49) refer to the number of nodes and edges in the graph.
# The description also lists node &amp; edge attributes


# We can access the nodes, edges, and their attributes:
E(net)
V(net)
E(net)$type
V(net)$media

# Or find specific nodes and edges by attribute:
# (that returns objects of type vertex sequence / edge sequence)
V(net)[media==&quot;BBC&quot;]
E(net)[type==&quot;mention&quot;]


# If you need them, you can extract an edge list 
# or a matrix back from the igraph networks.
as_edgelist(net, names=T)
as_adjacency_matrix(net, attr=&quot;weight&quot;)

# Or data frames describing nodes and edges:
as_data_frame(net, what=&quot;edges&quot;)
as_data_frame(net, what=&quot;vertices&quot;)


# You can also access the network matrix directly:
net[1,]
net[5,7]

# First attempt to plot the graph:
plot(net) # not pretty!

# Removing loops from the graph:
net &lt;- simplify(net, remove.multiple = F, remove.loops = T) 

# Let&#39;s and reduce the arrow size and remove the labels:
plot(net, edge.arrow.size=.4,vertex.label=NA)
 

# -------~~ DATASET 2: matrix  --------

 
# Read in the data:
nodes2 &lt;- read.csv(&quot;./Data files/Dataset2-Media-User-Example-NODES.csv&quot;, header=T, as.is=T)
links2 &lt;- read.csv(&quot;./Data files/Dataset2-Media-User-Example-EDGES.csv&quot;, header=T, row.names=1)

# Examine the data:
head(nodes2)
head(links2)

# links2 is a matrix for a two-mode network:
links2 &lt;- as.matrix(links2)
dim(links2)
dim(nodes2)

# Create an igraph network object from the two-mode matrix: 
net2 &lt;- graph_from_incidence_matrix(links2)

# To transform a one-mode network matrix into an igraph object,
# we would use graph_from_adjacency_matrix()


# A built-in vertex attribute &#39;type&#39; shows which mode vertices belong to.
table(V(net2)$type)

plot(net2,vertex.label=NA)

# Examine the resulting object:
class(net2)
net2 




# ================ 3. Network plots in &#39;igraph&#39; ================
 

#  ------~~ Plot parameters in igraph --------

# Check out the node options (starting with &#39;vertex.&#39;) 
# and the edge options # (starting with &#39;edge.&#39;). 
# A list of options is also included in your handout.
?igraph.plotting

# We can set the node &amp; edge options in two ways - one is to specify
# them in the plot() function, as we are doing below.

# Plot with curved edges (edge.curved=.1) and reduce arrow size:
plot(net, edge.arrow.size=.4, edge.curved=.1)

# Set node color to orange and the border color to hex #555555
# Replace the vertex label with the node names stored in &quot;media&quot;
plot(net, edge.arrow.size=.2, edge.curved=0,
     vertex.color=&quot;orange&quot;, vertex.frame.color=&quot;#555555&quot;,
     vertex.label=V(net)$media, vertex.label.color=&quot;black&quot;,
     vertex.label.cex=.7) 

# The second way to set attributes is to add them to the igraph object.

# Generate colors based on media type:
colrs &lt;- c(&quot;gray50&quot;, &quot;tomato&quot;, &quot;gold&quot;)
V(net)$color &lt;- colrs[V(net)$media.type]


# Compute node degrees (#links) and use that to set node size:
deg &lt;- degree(net, mode=&quot;all&quot;)
V(net)$size &lt;- deg*3
# Alternatively, we can set node size based on audience size:
V(net)$size &lt;- V(net)$audience.size*0.7

# The labels are currently node IDs.
# Setting them to NA will render no labels:
V(net)$label.color &lt;- &quot;black&quot;
V(net)$label &lt;- NA

# Set edge width based on weight:
E(net)$width &lt;- E(net)$weight/6

#change arrow size and edge color:
E(net)$arrow.size &lt;- .2
E(net)$edge.color &lt;- &quot;gray80&quot;

# We can even set the network layout:
graph_attr(net, &quot;layout&quot;) &lt;- layout_with_lgl
plot(net) 

# We can also override the attributes explicitly in the plot:
plot(net, edge.color=&quot;orange&quot;, vertex.color=&quot;gray50&quot;) 


# We can also add a legend explaining the meaning of the colors we used:
plot(net) 
legend(x=-1.1, y=-1.1, c(&quot;Newspaper&quot;,&quot;Television&quot;, &quot;Online News&quot;), pch=21,
       col=&quot;#777777&quot;, pt.bg=colrs, pt.cex=2.5, bty=&quot;n&quot;, ncol=1)


# Sometimes, especially with semantic networks, we may be interested in 
# plotting only the labels of the nodes:

plot(net, vertex.shape=&quot;none&quot;, vertex.label=V(net)$media, 
     vertex.label.font=2, vertex.label.color=&quot;gray40&quot;,
     vertex.label.cex=.7, edge.color=&quot;gray85&quot;)


# Let&#39;s color the edges of the graph based on their source node color.
# We&#39;ll get the starting node for each edge with &quot;ends()&quot;.
edge.start &lt;- ends(net, es=E(net), names=F)[,1]
edge.col &lt;- V(net)$color[edge.start]

plot(net, edge.color=edge.col, edge.curved=.4)



#  -------~~ Network Layouts in &#39;igraph&#39; --------


# Network layouts are algorithms that return coordinates for each
# node in a network.

# Let&#39;s generate a slightly larger 100-node graph using 
# a preferential attachment model (Barabasi-Albert).

net.bg &lt;- sample_pa(100, 1.2) 
V(net.bg)$size &lt;- 8
V(net.bg)$frame.color &lt;- &quot;white&quot;
V(net.bg)$color &lt;- &quot;orange&quot;
V(net.bg)$label &lt;- &quot;&quot; 
E(net.bg)$arrow.mode &lt;- 0
plot(net.bg)

# Now let&#39;s plot this network using the layouts available in igraph.

# You can set the layout in the plot function:
plot(net.bg, layout=layout_randomly)

# Or calculate the vertex coordinates in advance:
l &lt;- layout_in_circle(net.bg)
plot(net.bg, layout=l)

# l is simply a matrix of x,y coordinates (N x 2) for the N nodes in the graph. 
# You can generate your own:
l
l &lt;- cbind(1:vcount(net.bg), c(1, vcount(net.bg):2))
plot(net.bg, layout=l)

# This layout is just an example and not very helpful - thankfully
# &#39;igraph&#39; has a number of built-in layouts, including:

# Randomly placed vertices
l &lt;- layout_randomly(net.bg)
plot(net.bg, layout=l)

# Circle layout
l &lt;- layout_in_circle(net.bg)
plot(net.bg, layout=l)

# 3D sphere layout
l &lt;- layout_on_sphere(net.bg)
plot(net.bg, layout=l)

# The Fruchterman-Reingold force-directed algorithm 
# Nice but slow, most often used in graphs smaller than ~1000 vertices. 
l &lt;- layout_with_fr(net.bg)
plot(net.bg, layout=l)

# You will also notice that the F-R layout is not deterministic - different 
# runs will result in slightly different configurations. Saving the layout 
# in l allows us to get the exact same result multiple times.
par(mfrow=c(2,2), mar=c(1,1,1,1))
plot(net.bg, layout=layout_with_fr)
plot(net.bg, layout=layout_with_fr)
plot(net.bg, layout=l)
plot(net.bg, layout=l)

dev.off()

# By default, the coordinates of the plots are rescaled to the [-1,1] interval
# for both x and y. You can change that with the parameter &quot;rescale=FALSE&quot;
# and rescale your plot manually by multiplying the coordinates by a scalar.
# You can use norm_coords to normalize the plot with the boundaries you want.
# This way you can create more compact or spread out layout versions.

# Get the layout coordinates:
l &lt;- layout_with_fr(net.bg)
# Normalize them so that they are in the -1, 1 interval:
l &lt;- norm_coords(l, ymin=-1, ymax=1, xmin=-1, xmax=1)

par(mfrow=c(2,2), mar=c(0,0,0,0))
plot(net.bg, rescale=F, layout=l*0.4)
plot(net.bg, rescale=F, layout=l*0.8)
plot(net.bg, rescale=F, layout=l*1.2)
plot(net.bg, rescale=F, layout=l*1.6)

dev.off()

# Another popular force-directed algorithm that produces nice results for
# connected graphs is Kamada Kawai. Like Fruchterman Reingold, it attempts to 
# minimize the energy in a spring system.

l &lt;- layout_with_kk(net.bg)
plot(net.bg, layout=l)

#The MDS (multidimensional scaling) algorithm tries to place nodes based on some
# measure of similarity or distance between them. More similar/less distant nodes are
# placed closer to each other. By default, the measure used is based on the shortest 
#paths between nodes in the network. That can be changed with the &#39;dist&#39; parameter.
plot(net.bg, layout=layout_with_mds)

# The LGL algorithm is for large connected graphs. Here you can specify a root - 
# the node that will be placed in the middle of the layout.
plot(net.bg, layout=layout_with_lgl)


# By default, igraph uses a layout called &#39;layout_nicely&#39; which selects
# an appropriate layout algorithm based on the properties of the graph. 

# Check out all available layouts in igraph:
?igraph::layout_

layouts &lt;- grep(&quot;^layout_&quot;, ls(&quot;package:igraph&quot;), value=TRUE)[-1] 
# Remove layouts that do not apply to our graph.
layouts &lt;- layouts[!grepl(&quot;bipartite|merge|norm|sugiyama|tree&quot;, layouts)]

par(mfrow=c(3,3), mar=c(1,1,1,1))

for (layout in layouts) {
  print(layout)
  l &lt;- do.call(layout, list(net)) 
  plot(net, edge.arrow.mode=0, layout=l, main=layout) }

dev.off()



# -------~~ Highlighting aspects of the network --------


plot(net)

# Notice that our network plot is still not too helpful.
# We can identify the type and size of nodes, but cannot see
# much about the structure since the links we&#39;re examining are so dense.
# One way to approach this is to see if we can sparsify the network.

hist(links$weight)
mean(links$weight)
sd(links$weight)

# There are more sophisticated ways to extract the key edges,
# but for the purposes of this exercise we&#39;ll only keep ones
# that have weight higher than the mean for the network.

# We can delete edges using delete_edges(net, edges)
# (or, by the way, add edges with add_edges(net, edges) )
cut.off &lt;- mean(links$weight) 
net.sp &lt;- delete_edges(net, E(net)[weight&lt;cut.off])
plot(net.sp, layout=layout_with_kk) 


# Another way to think about this is to plot the two tie types 
# (hyperlinks and mentions) separately. We will do that in 
# section 5 of this tutorial: Plotting multiplex networks.


# We can also try to make the network map more useful by
# showing the communities within it.

# Community detection (by optimizing modularity over partitions):
clp &lt;- cluster_optimal(net)
class(clp)
clp$membership

# Community detection returns an object of class &quot;communities&quot; 
# which igraph knows how to plot: 
plot(clp, net)
 
# We can also plot the communities without relying on their built-in plot:
V(net)$community &lt;- clp$membership
colrs &lt;- adjustcolor( c(&quot;gray50&quot;, &quot;tomato&quot;, &quot;gold&quot;, &quot;yellowgreen&quot;), alpha=.6)
plot(net, vertex.color=colrs[V(net)$community])



# -------~~ Highlighting specific nodes or links --------


# Sometimes we want to focus the visualization on a particular node
# or a group of nodes. Let&#39;s represent distance from the NYT:
# distances() calculates shortest parth from vertices in &#39;v&#39; to ones in &#39;to&#39;.
dist.from.NYT &lt;- distances(net, v=V(net)[media==&quot;NY Times&quot;], to=V(net), weights=NA)

# Set colors to plot the distances:
oranges &lt;- colorRampPalette(c(&quot;dark red&quot;, &quot;gold&quot;))
col &lt;- oranges(max(dist.from.NYT)+1)
col &lt;- col[dist.from.NYT+1]
 
plot(net, vertex.label=dist.from.NYT, 
     vertex.color=col, vertex.label.color=&quot;white&quot;)

# Or, a bit more readable:
plot(net, vertex.color=col, vertex.label=dist.from.NYT, edge.arrow.size=.6, 
     vertex.label.color=&quot;white&quot;, vertex.size=V(net)$size*1.6, edge.width=2,
     layout=norm_coords(layout_with_lgl(net))*1.4, rescale=F)


# We can also highlight paths between the nodes in the network.
# Say here between MSNBC and the New York Post:
news.path &lt;- shortest_paths(net, 
                            from = V(net)[media==&quot;MSNBC&quot;], 
                            to  = V(net)[media==&quot;New York Post&quot;],
                            output = &quot;both&quot;) # both path nodes and edges

# Generate edge color variable to plot the path:
ecol &lt;- rep(&quot;gray80&quot;, ecount(net))
ecol[unlist(news.path$epath)] &lt;- &quot;orange&quot;
# Generate edge width variable to plot the path:
ew &lt;- rep(2, ecount(net))
ew[unlist(news.path$epath)] &lt;- 4
# Generate node color variable to plot the path:
vcol &lt;- rep(&quot;gray40&quot;, vcount(net))
vcol[unlist(news.path$vpath)] &lt;- &quot;gold&quot;

plot(net, vertex.color=vcol, edge.color=ecol, 
     edge.width=ew, edge.arrow.mode=0)


# Highlight the edges going into or out of a vertex, for instance the WSJ.
# For a single node, use &#39;incident()&#39;, for multiple nodes use &#39;incident_edges()&#39;
inc.edges &lt;- incident(net, V(net)[media==&quot;Wall Street Journal&quot;], mode=&quot;all&quot;)

# Set colors to plot the selected edges.
ecol &lt;- rep(&quot;gray80&quot;, ecount(net))
ecol[inc.edges] &lt;- &quot;orange&quot;
vcol &lt;- rep(&quot;grey40&quot;, vcount(net))
vcol[V(net)$media==&quot;Wall Street Journal&quot;] &lt;- &quot;gold&quot;
plot(net, vertex.color=vcol, edge.color=ecol, edge.width=2)


# Or we can highlight the immediate neighbors of a vertex, say WSJ.
# The &#39;neighbors&#39; function finds all nodes one step out from the focal actor.
# To find the neighbors for multiple nodes, use &#39;adjacent_vertices()&#39;.
# To find node neighborhoods going more than one step out, use function &#39;ego()&#39;
# with parameter &#39;order&#39; set to the number of steps out to go from the focal node(s).

neigh.nodes &lt;- neighbors(net, V(net)[media==&quot;Wall Street Journal&quot;], mode=&quot;out&quot;)

# Set colors to plot the neighbors:
vcol[neigh.nodes] &lt;- &quot;#ff9d00&quot;
plot(net, vertex.color=vcol)
 

# Another way to draw attention to a group of nodes:
# (This is generally not recommended since, depending on layout, nodes
#  that are not &#39;marked&#39; can accidentally get placed on top of the mark)
plot(net, mark.groups=c(1,4,5,8), mark.col=&quot;#C5E5E7&quot;, mark.border=NA)
# Mark multiple groups:
plot(net, mark.groups=list(c(1,4,5,8), c(15:17)), 
          mark.col=c(&quot;#C5E5E7&quot;,&quot;#ECD89A&quot;), mark.border=NA)



# -------~~ Interactive plotting with &#39;tkplot&#39; -------- 

# R and igraph offer interactive plotting capabilities
# (mostly helpful for small networks)

tkid &lt;- tkplot(net) #tkid is the id of the tkplot

l &lt;- tkplot.getcoords(tkid) # grab the coordinates from tkplot
plot(net, layout=l)



# -------~~ Other ways to represent a network -------- 

# One reminder that there are other ways to represent a network:

# Heatmap of the network matrix:
netm &lt;- as_adjacency_matrix(net, attr=&quot;weight&quot;, sparse=F)
colnames(netm) &lt;- V(net)$media
rownames(netm) &lt;- V(net)$media

palf &lt;- colorRampPalette(c(&quot;gold&quot;, &quot;dark orange&quot;)) 

# The Rowv &amp; Colv parameters turn dendrograms on and off
heatmap(netm[,17:1], Rowv = NA, Colv = NA, col = palf(20), 
        scale=&quot;none&quot;, margins=c(10,10) )

# Degree distribution
deg.dist &lt;- degree_distribution(net, cumulative=T, mode=&quot;all&quot;)
plot( x=0:max(degree(net)), y=1-deg.dist, pch=19, cex=1.4, col=&quot;orange&quot;, 
      xlab=&quot;Degree&quot;, ylab=&quot;Cumulative Frequency&quot;)



# ================ 4. Plotting two-mode networks ================


head(nodes2)
head(links2)

net2
plot(net2)

# This time we will make nodes look different based on their type.
# Media outlets are blue squares, audience nodes are orange circles:
V(net2)$color &lt;- c(&quot;steel blue&quot;, &quot;orange&quot;)[V(net2)$type+1]
V(net2)$shape &lt;- c(&quot;square&quot;, &quot;circle&quot;)[V(net2)$type+1]

# Media outlets will have name labels, audience members will not:
V(net2)$label &lt;- &quot;&quot;
V(net2)$label[V(net2)$type==F] &lt;- nodes2$media[V(net2)$type==F] 
V(net2)$label.cex=.6
V(net2)$label.font=2

plot(net2, vertex.label.color=&quot;white&quot;, vertex.size=(2-V(net2)$type)*8) 

# igraph has a built-in bipartite layout, though it&#39;s not the most helpful:
plot(net2, vertex.label=NA, vertex.size=7, layout=layout_as_bipartite) 

 
# Using text as nodes:
par(mar=c(0,0,0,0))
plot(net2, vertex.shape=&quot;none&quot;, vertex.label=nodes2$media,
     vertex.label.color=V(net2)$color, vertex.label.font=2, 
     vertex.label.cex=.95, edge.color=&quot;gray70&quot;,  edge.width=2)

dev.off()


# Using images as nodes
# You will need the &#39;png&#39; package to do this:

# install.packages(&quot;png&quot;)
library(&quot;png&quot;)
 
img.1 &lt;- readPNG(&quot;./Data files/images/news.png&quot;)
img.2 &lt;- readPNG(&quot;./Data files/images/user.png&quot;)

V(net2)$raster &lt;- list(img.1, img.2)[V(net2)$type+1]

par(mar=c(3,3,3,3))

plot(net2, vertex.shape=&quot;raster&quot;, vertex.label=NA,
     vertex.size=16, vertex.size2=16, edge.width=2)

# By the way, you can also add any image you want to any plot.
# For example, many network graphs could be improved by a photo
# of a puppy carrying a basket full of kittens.
img.3 &lt;- readPNG(&quot;./Data files/images/puppy.png&quot;)
rasterImage(img.3,  xleft=-1.7, xright=0, ybottom=-1.2, ytop=0)


# The numbers after the image are coordinates for the plot.
# The limits of your plotting area are given in par()$usr

dev.off()

detach(&quot;package:png&quot;) 

# We can also generate and plot bipartite projections for the two-mode network:
# (co-memberships are easy to calculate by multiplying the network matrix by
# its transposed matrix, or using igraph&#39;s bipartite.projection function)

net2.bp &lt;- bipartite.projection(net2)

# We can calculate the projections manually as well:
#   as_incidence_matrix(net2)  %*% t(as_incidence_matrix(net2))
# t(as_incidence_matrix(net2)) %*%   as_incidence_matrix(net2)

par(mfrow=c(1,2))

plot(net2.bp$proj1, vertex.label.color=&quot;black&quot;, vertex.label.dist=2,
     vertex.label=nodes2$media[!is.na(nodes2$media.type)])

plot(net2.bp$proj2, vertex.label.color=&quot;black&quot;, vertex.label.dist=2,
     vertex.label=nodes2$media[ is.na(nodes2$media.type)])

dev.off()

# PSA: Remember to detach packages when you are done with them!
# You may run into problems if you have igraph and Statnet packages loaded together.
detach(&quot;package:igraph&quot;)



# ================ 5. Plotting multiplex networks ================


# In some cases, the networks we want to plot are multigraphs: 
# they can have multiple edges connecting the same two nodes. 
#
# A related concept, multiplex networks, contain multiple types of ties
# -- e.g. friendship, romantic, and work relationships between individuals. 

# In our example network, we also have two tie types: hyperlinks and mentions. 

# One thing we can do is plot each type of tie separately:

library(&quot;igraph&quot;)

E(net)$width &lt;- 2
plot(net, edge.color=c(&quot;dark red&quot;, &quot;slategrey&quot;)[(E(net)$type==&quot;hyperlink&quot;)+1],
      vertex.color=&quot;gray40&quot;, layout=layout_in_circle, edge.curved=.3)

# Another way to delete edges using the minus operator:  
net.m &lt;- net - E(net)[E(net)$type==&quot;hyperlink&quot;]
net.h &lt;- net - E(net)[E(net)$type==&quot;mention&quot;]

# Plot the two links separately:
par(mfrow=c(1,2))

plot(net.h, vertex.color=&quot;orange&quot;, layout=layout_with_fr, main=&quot;Tie: Hyperlink&quot;)
plot(net.m, vertex.color=&quot;lightsteelblue2&quot;, layout=layout_with_fr, main=&quot;Tie: Mention&quot;)

dev.off()

# Make sure the nodes stay in the same place in both plots:
par(mfrow=c(1,2),mar=c(1,1,4,1))

l &lt;- layout_with_fr(net)
plot(net.h, vertex.color=&quot;orange&quot;, layout=l, main=&quot;Tie: Hyperlink&quot;)
plot(net.m, vertex.color=&quot;lightsteelblue2&quot;, layout=l, main=&quot;Tie: Mention&quot;)

dev.off()

# In our example network, we don&#39;t have node dyads connected by multiple
# types of connections (we never have both a &#39;hyperlink&#39; and a &#39;mention&#39;
# tie between the same two news outlets) -- however that could happen.

# One challenge in visualizing multiplex networks is that multiple 
# edges between the same two nodes may get plotted on top of each 
# other in a way that makes them impossible to distinguish. 

# For example, let us generate a simple multiplex network with
# two nodes and three ties between them:

multigtr &lt;- graph( edges=c(1,2, 1,2, 1,2), n=2 )

l &lt;- layout_with_kk(multigtr)

# Let&#39;s just plot the graph:
plot(multigtr, vertex.color=&quot;lightsteelblue&quot;, vertex.frame.color=&quot;white&quot;,
     vertex.size=40, vertex.shape=&quot;circle&quot;, vertex.label=NA,
     edge.color=c(&quot;gold&quot;, &quot;tomato&quot;, &quot;yellowgreen&quot;), edge.width=10,
     edge.arrow.size=5, edge.curved=0.1, layout=l)

# Because all edges in the graph have the same curvature, they are drawn
# over each other so that we only see the last one. What we can do is 
# assign each edge a different curvature. One useful function in &#39;igraph&#39;
# called curve_multiple() can help us here. For a graph G, curve.multiple(G)
# will generate a curvature for each edge that maximizes visibility.

plot(multigtr, vertex.color=&quot;lightsteelblue&quot;, vertex.frame.color=&quot;white&quot;, 
     vertex.size=40, vertex.shape=&quot;circle&quot;, vertex.label=NA,
     edge.color=c(&quot;gold&quot;, &quot;tomato&quot;, &quot;yellowgreen&quot;), edge.width=10,
     edge.arrow.size=5, edge.curved=curve_multiple(multigtr), layout=l)


dev.off()

detach(&quot;package:igraph&quot;)

# ================ 6. Quick example using the &#39;network&#39; package ================

# Plotting with the &#39;network&#39; package is very similar to that with &#39;igraph&#39; -
# although the notation is slightly different (a whole new set of parameter names!)
# Here is a quick example using the (by now very familiar) media network.

#Just in case we have forgotten this earlier:
dev.off()
detach(&quot;package:igraph&quot;)

# Load our main package:
library(&quot;network&quot;)

# Wait, what did our data look like?
head(links)
head(nodes)

# Convert the data into the network format used by the Statnet family.
# As in igraph, we can generate a &#39;network&#39; object from an edgelist, 
# an adjacency matrix, or an incidence matrix. 
?edgeset.constructors

# Remember to set the &#39;ignore.eval&#39; to F for weighted networks.
# We would need to set &#39;multile&#39; to T if we wanted to allow multiplex edges.
net3 &lt;- network(links, vertex.attr=nodes, matrix.type=&quot;edgelist&quot;, 
                loops=F, multiple=F, ignore.eval = F)
net3

# You can access the edges, vertices, and the network matrix using:
net3[,]
net3 %n% &quot;net.name&quot; &lt;- &quot;Media Network&quot; #  network attribute
net3 %v% &quot;media&quot;    # Node attribute
net3 %e% &quot;type&quot;     # Edge attribute
 
net3 %v% &quot;col&quot; &lt;- c(&quot;gray70&quot;, &quot;tomato&quot;, &quot;gold&quot;)[net3 %v% &quot;media.type&quot;]

# plot the network:
plot(net3, vertex.cex=(net3 %v% &quot;audience.size&quot;)/7, vertex.col=&quot;col&quot;)

# For a full list of parameters that you can use in this plot, 
# check out ?plot.network.
?plot.network

# Note that - as in igraph - the plot returns the node position coordinates.
l &lt;- plot(net3, vertex.cex=(net3 %v% &quot;audience.size&quot;)/7, vertex.col=&quot;col&quot;)
plot(net3, vertex.cex=(net3 %v% &quot;audience.size&quot;)/7, vertex.col=&quot;col&quot;, coord=l)


# The network package also offers the option to edit a plot interactively,
# by setting the parameter interactive=T

plot(net3, vertex.cex=(net3 %v% &quot;audience.size&quot;)/7, vertex.col=&quot;col&quot;, interactive=T)


detach(&quot;package:network&quot;)




# ================ 7. Simple plot animations in R ================

# If you have already installed &quot;ndtv&quot;, you should also have
# a package used by it called &quot;animation&quot;.

# install.packages(&quot;animation&quot;)
library(&quot;animation&quot;)
library(&quot;igraph&quot;)

# In order for this to work, you need not only the R package, but also
# an additional software called ImageMagick from imagemagick.org 
# If you don&#39;t already have it, skip this part of the tutorial for now.

ani.options(&quot;convert&quot;) # Check that the package knows where to find ImageMagick
ani.options(convert=&quot;C:/Progra~1/ImageMagick-7.0.6-Q16/convert.exe&quot;) 

# You can use this technique to create various (not necessarily network-related)
# animations in R by generating multiple plots and combining them in an animated GIF.

l &lt;- layout_with_lgl(net)

saveGIF( {  col &lt;- rep(&quot;grey40&quot;, vcount(net))
            plot(net, vertex.color=col, layout=l)
            
            step.1 &lt;- V(net)[media==&quot;Wall Street Journal&quot;]
            col[step.1] &lt;- &quot;#ff5100&quot;
            plot(net, vertex.color=col, layout=l)
            
            step.2 &lt;- unlist(neighborhood(net, 1, step.1, mode=&quot;out&quot;))
            col[setdiff(step.2, step.1)] &lt;- &quot;#ff9d00&quot;
            plot(net, vertex.color=col, layout=l) 
            
            step.3 &lt;- unlist(neighborhood(net, 2, step.1, mode=&quot;out&quot;))
            col[setdiff(step.3, step.2)] &lt;- &quot;#FFDD1F&quot;
            plot(net, vertex.color=col, layout=l)  },
          interval = .8, movie.name=&quot;network_animation.gif&quot; )

 detach(&quot;package:igraph&quot;)
 detach(&quot;package:animation&quot;)




# ================ 8. Interactive JavaScript networks ================


# There are a number of libraries like &#39;rcharts&#39; and &#39;htmlwidgets&#39; that can help you 
# export interactive web charts from R. We&#39;ll take a quick look at three packages that
# can export networks from R to JavaScript: : &#39;visNetwork&#39; and &#39;threejs&#39;, and &#39;networkD3&#39;


# -------~~  Interactive networks with visNetwork --------

# install.packages(&quot;visNetwork&quot;)

library(&quot;visNetwork&quot;) 

head(nodes)
head(links)

# We can visualize the network right away - visNetwork() will accept 
# our node and link data frames (it needs node data with an &#39;id&#39; column,
# and edge data with &#39;from&#39; and &#39;to&#39; columns).

visNetwork(nodes, links)

# We can set the height and width of the  visNetwork() window 
# with parameters &#39;height&#39; and &#39;width&#39;, the back color with &#39;background&#39;,
# the title, subtitle, and footer with &#39;main&#39;, &#39;submain&#39;, and &#39;footer&#39;

visNetwork(nodes, links, height=&quot;300px&quot;, width=&quot;100%&quot;, background=&quot;#eeefff&quot;,
           main=&quot;Network&quot;, submain=&quot;And what a great network it is!&quot;,
           footer= &quot;Hyperlinks and mentions among media sources&quot;)

# Like &#39;igraph&#39; did, &#39;visNetwork&#39; allows us to set graphic properties 
# as node or edge attributes directly in the data or through a function.

# Check out the available options with:
?visNodes
?visEdges
 

# We&#39;ll start by adding new node and edge attributes to our dataframes. 
# We&#39;ll leave our original data alone and create two new data frames:
vis.nodes &lt;- nodes
vis.links &lt;- links

# The options for node shape include &#39;ellipse&#39;, &#39;circle&#39;, 
# &#39;database&#39;, &#39;box&#39;, &#39;text&#39;, &#39;image&#39;, &#39;circularImage&#39;, &#39;diamond&#39;, 
# &#39;dot&#39;, &#39;star&#39;, &#39;triangle&#39;, &#39;triangleDown&#39;, &#39;square&#39;, and &#39;icon&#39;

vis.nodes$shape  &lt;- &quot;dot&quot;  
vis.nodes$shadow &lt;- TRUE # Nodes will drop shadow
vis.nodes$title  &lt;- vis.nodes$media # Text on click
vis.nodes$label  &lt;- vis.nodes$type.label # Node label
vis.nodes$size   &lt;- vis.nodes$audience.size # Node size
vis.nodes$borderWidth &lt;- 2 # Node border width
 
# We can set the color for several elements of the nodes:
# &quot;background&quot; changes the node color, &quot;border&quot; changes the frame color;
# &quot;highlight&quot; sets the color on click, &quot;hover&quot; sets the color on mouseover.

vis.nodes$color.background &lt;- c(&quot;slategrey&quot;, &quot;tomato&quot;, &quot;gold&quot;)[nodes$media.type]
vis.nodes$color.border &lt;- &quot;black&quot;
vis.nodes$color.highlight.background &lt;- &quot;orange&quot;
vis.nodes$color.highlight.border &lt;- &quot;darkred&quot;

visNetwork(vis.nodes, vis.links)

# Below we change some of the visual properties of the edges:

vis.links$width &lt;- 1+links$weight/8 # line width
vis.links$color &lt;- &quot;gray&quot;    # line color  
vis.links$arrows &lt;- &quot;middle&quot; # arrows: &#39;from&#39;, &#39;to&#39;, or &#39;middle&#39;
vis.links$smooth &lt;- FALSE    # should the edges be curved?
vis.links$shadow &lt;- FALSE    # edge shadow

visNetwork(vis.nodes, vis.links)

# Remove the arrows and set the edge width to 1:
vis.links$arrows &lt;- &quot;&quot; 
vis.links$width  &lt;- 1
visnet &lt;- visNetwork(vis.nodes, vis.links)
visnet

# We can also set the visualization options directly with visNodes() and visEdges()
visnet2 &lt;- visNetwork(nodes, links)
visnet2 &lt;- visNodes(visnet2, shape = &quot;square&quot;, shadow = TRUE, 
                    color=list(background=&quot;gray&quot;, highlight=&quot;orange&quot;, border=&quot;black&quot;))
visnet2 &lt;- visEdges(visnet2, color=list(color=&quot;black&quot;, highlight = &quot;orange&quot;),
                    smooth = FALSE, width=2, dashes= TRUE, arrows = &#39;middle&#39; ) 
visnet2


# &#39;visNetwork&#39; offers a number of options, including highlighting the neighbors
#  of a selected node, or adding a drop-down menu to select a subset of nodes. 
# The subset is based on a column from our data - here the type label. 
visOptions(visnet, highlightNearest = TRUE, selectedBy = &quot;type.label&quot;)
 

# &#39;visNetwork&#39; can also work with predefined groups of nodes.
# Visual characteristics for each group can be set with visGroups().
nodes$group &lt;- nodes$type.label 
visnet3 &lt;- visNetwork(nodes, links)
visnet3 &lt;- visGroups(visnet3, groupname = &quot;Newspaper&quot;, shape = &quot;square&quot;,
                     color = list(background = &quot;gray&quot;, border=&quot;black&quot;))
visnet3 &lt;- visGroups(visnet3, groupname = &quot;TV&quot;, shape = &quot;dot&quot;,       
                     color = list(background = &quot;tomato&quot;, border=&quot;black&quot;))
visnet3 &lt;- visGroups(visnet3, groupname = &quot;Online&quot;, shape = &quot;diamond&quot;,   
                     color = list(background = &quot;orange&quot;, border=&quot;black&quot;))
visLegend(visnet3, main=&quot;Legend&quot;, position=&quot;right&quot;, ncol=1) 


# For more information, check out:
?visOptions # available options 
?visLayout  # available layouts
?visGroups  # using node groups
?visLegend  # adding a legend
 
detach(&quot;package:visNetwork&quot;)



# -------~~ Interactive networks with threejs --------

# Another package exporting networks from R to a js library is &#39;threejs&#39;
# The nice thing about it is that it can read igraph objects.

# install.packages(&quot;threejs&quot;)

# If you get errors or warnings using this library and the latest R version,
# try installing the development version of the &#39;htmlwidgets&#39; package
# devtools::install_github(&quot;ramnathv/htmlwidgets&quot;)


library(&quot;threejs&quot;)
library(&quot;htmlwidgets&quot;)
library(&quot;igraph&quot;)
 
# The main network plotting function - graphjs() will take an igraph object.
# We could use our initial &#39;net&#39; object with a slight modification - we will
# delete its graph layout and let &#39;threejs&#39; generate its own layout.
# (We cheated a bit by assigning a function to the layout attribute above 
# rather than giving it a table of node coordinates. This is fine by &#39;igraph&#39;,
# but &#39;threejs&#39; will not let us do it.
 
net.js &lt;- net
graph_attr(net.js, &quot;layout&quot;) &lt;- NULL

# Note that RStudio for Windows may not render the &#39;threejs&#39; graphics properly.
# We will save the output in an HTML file and open it in a browser.
# Some of the parameters that we can add include &#39;main&#39; for the plot title;
# &#39;curvature&#39; for the edge curvature; &#39;bg&#39; for background color; 
# &#39;showLabels&#39; to set labels to visible (TRUE) or not (FALSE); 
# &#39;attraction&#39; and &#39;repulsion&#39; to set how much nodes attract and repulse
# each other; &#39;opacity&#39; for node transparency (0 to 1); &#39;stroke&#39; to indicate
# whether nodes should be framed in a black circle (TRUE) or not (FALSE), etc.
# For the full list of parameters, check out ?graphjs

gjs &lt;- graphjs(net.js, main=&quot;Network!&quot;, bg=&quot;gray10&quot;, showLabels=F, stroke=F, 
               curvature=0.1, attraction=0.9, repulsion=0.8, opacity=0.9)
print(gjs)
saveWidget(gjs, file=&quot;Media-Network-gjs.html&quot;)
browseURL(&quot;Media-Network-gjs.html&quot;)
 
# Once we open the resulting visualization in the browser, we can use the mouse to
# control it: scrollwheel to zoom in and out, the left mouse button to rotate 
# the network, and the right mouse button to pan. 

# We can also create simple animations with &#39;threejs&#39; by using lists of
# layouts, vertex colors, and edge colors that will switch at each step.

gjs.an &lt;- graphjs(net.js, bg=&quot;gray10&quot;, showLabels=F, stroke=F, 
                  layout=list(layout_randomly(net.js, dim=3),
                              layout_with_fr(net.js,  dim=3),
                              layout_with_drl(net.js, dim=3),  
                              layout_on_sphere(net.js)),
                  vertex.color=list(V(net.js)$color, &quot;gray&quot;, &quot;orange&quot;, V(net.js)$color),
                  main=list(&quot;Random Layout&quot;, &quot;Fruchterman-Reingold&quot;, &quot;DrL layout&quot;, &quot;Sphere&quot; ) )
print(gjs.an)
saveWidget(gjs.an, file=&quot;Media-Network-gjs-an.html&quot;)
browseURL(&quot;Media-Network-gjs-an.html&quot;)

# Another example is the &#39;Les Miserables&#39; network included with the package:

data(LeMis)
lemis.net &lt;- graphjs(LeMis, main=&quot;Les Miserables&quot;, showLabels=T)
print(lemis.net)
saveWidget(lemis.net, file=&quot;LeMis-Network-gjs.html&quot;)
browseURL(&quot;LeMis-Network-gjs.html&quot;)
 
detach(&quot;package:igraph&quot;)
detach(&quot;package:threejs&quot;)
detach(&quot;package:htmlwidgets&quot;)


# -------~~  Interactive Networks with networkD3 --------

# Another package using JavaScript to export networks: networkD3

# install.packages(&quot;networkD3&quot;)

library(&quot;networkD3&quot;) 
 
# d3ForceNetwork expects node IDs that are numeric and start from 0
# so we have to transform our character node IDs:

links.d3 &lt;- data.frame(from=as.numeric(factor(links$from))-1, 
                 to=as.numeric(factor(links$to))-1 )

# The nodes need to be in the same order as the &quot;source&quot; column in links:
nodes.d3 &lt;- cbind(idn=factor(nodes$media, levels=nodes$media), nodes) 

# The `Group` parameter is used to color the nodes.
# Nodesize is not (as you might think) the size of the node, but the
# number of the column in the node data that should be used for sizing.
# The `charge` parameter guides node repulsion (if negative) or 
# attraction (if positive).

forceNetwork(Links = links.d3, Nodes = nodes.d3, Source=&quot;from&quot;, Target=&quot;to&quot;,
               NodeID = &quot;idn&quot;, Group = &quot;type.label&quot;,linkWidth = 1,
               linkColour = &quot;#afafaf&quot;, fontSize=12, zoom=T, legend=T,
               Nodesize=6, opacity = 1, charge=-600, 
               width = 600, height = 600)
                 

detach(&quot;package:networkD3&quot;)




# ================ 9. Interactive and dynamic networks with ndtv-d3 ================



# -------~~ Interactive network plots --------


# install.packages(&quot;ndtv&quot;, dependencies=T)

library(&quot;ndtv&quot;)

# You should not need additional software to produce web animations with &#39;ndtv&#39; (below).
# If you want to save the animations as  video  files ( see ?saveVideo), you have to
# install a video converter called FFmpeg (ffmpg.org). To find out how to get the right 
# installation for your OS, check out ?install.ffmpeg  To use all available layouts, 
# you need to have Java installed on your machine.


# Remember net3, our original media network turned into a &#39;network&#39; object:
net3 

# Let&#39;s create an interactive (but not yet dynamic!) visualization of net3.
# You will recognize a lot of the plotting parameters from &#39;network&#39;:
# Two new parameters set the tooltips (the popup labels you see when you 
# click on network elements); note that those can take html format.
# &#39;launchBrowser=T&#39; will open file &#39;filename&#39; in your default browser.

render.d3movie(net3, usearrows = F, displaylabels = F, bg=&quot;#111111&quot;, 
               vertex.border=&quot;#ffffff&quot;, vertex.col =  net3 %v% &quot;col&quot;,
               vertex.cex = (net3 %v% &quot;audience.size&quot;)/8, 
               edge.lwd = (net3 %e% &quot;weight&quot;)/3, edge.col = &#39;#55555599&#39;,
               vertex.tooltip = paste(&quot;&lt;b&gt;Name:&lt;/b&gt;&quot;, (net3 %v% &#39;media&#39;) , &quot;&lt;br&gt;&quot;,
                                    &quot;&lt;b&gt;Type:&lt;/b&gt;&quot;, (net3 %v% &#39;type.label&#39;)),
               edge.tooltip = paste(&quot;&lt;b&gt;Edge type:&lt;/b&gt;&quot;, (net3 %e% &#39;type&#39;), &quot;&lt;br&gt;&quot;, 
                                  &quot;&lt;b&gt;Edge weight:&lt;/b&gt;&quot;, (net3 %e% &#39;weight&#39; ) ),
               launchBrowser=T, filename=&quot;Media-Network.html&quot; )  

    
# If you are going to embed this in a markdown document, 
# you would also need to add output.mode=&#39;inline&#39; above.


# -------~~ Network evolution animations -------- 


# In order to work with the network animations in &#39;ndtv&#39;, 
# we need to understand the  dynamic network format used by 
# Statnet packages, implemented in &#39;networkDynamic&#39;. It can 
# represent discrete or continuous longitudinal network structures. 

# Let&#39;s look at one of the example datasets included in the
# package, containing simulation data based on the network of
# business connections among Renaissance Florentine families:

data(short.stergm.sim)
short.stergm.sim 
head(as.data.frame(short.stergm.sim))

# Here, an edge starts from a node with ID in `tail` and goes to one with ID in `head`. 
# Edges exist from time point `onset` to time point `terminus`. 
# There may be multiple periods (*activity spells*) where an edge is present. 
# Each of those periods is recorded on a separate row in the data frame.


# With dynamic data, we can use &#39;network.extract()&#39; to get a network  
# that only contains elements active at a given point/time interval.

# Plot the network ignoring time (all nodes &amp; edges that were ever present):
plot(short.stergm.sim)  

# Plot the network at time 1 (at=1):
plot( network.extract(short.stergm.sim, at=1) )

# Plot nodes &amp; edges active for the entire period (`rule=all`) from 1 to 5:
plot( network.extract(short.stergm.sim, onset=1, terminus=5, rule=&quot;all&quot;) )

#Plot nodes &amp; edges active at any point (`rule=any`) between 1 and 10:
plot( network.extract(short.stergm.sim, onset=1, terminus=10, rule=&quot;any&quot;) ) 

# Let&#39;s make a quick d3 animation from the example network:
render.d3movie(short.stergm.sim,displaylabels=TRUE) 


# Next, we will create and animate our own dynamic network.

# Dynamic network object can be generated in a number of ways: from 
# a set of networks/matrices representing different time points, or from
# data frames/matrices with node lists and edge lists indicating when each
# is active, or when they switch state. See ?networkDynamic for more information.

net3
plot(net3)

vs &lt;- data.frame(onset=0, terminus=50, vertex.id=1:17)
es &lt;- data.frame(onset=1:49, terminus=50, 
                 head=as.matrix(net3, matrix.type=&quot;edgelist&quot;)[,1],
                 tail=as.matrix(net3, matrix.type=&quot;edgelist&quot;)[,2])
head(vs)
head(es)

# Combine our base network with the edge and node longitudinal data:
net3.dyn &lt;- networkDynamic(base.net=net3, edge.spells=es, vertex.spells=vs)


# Plot the network (all elements present at any time point): 
plot(net3.dyn, vertex.cex=(net3 %v% &quot;audience.size&quot;)/7, vertex.col=&quot;col&quot;)


# Plot static images showing network evolution:


compute.animation(net3.dyn, animation.mode = &quot;kamadakawai&quot;,
                  slice.par=list(start=0, end=49, interval=10, 
                         aggregate.dur=10, rule=&#39;any&#39;))

# Show time evolution through static images at different time points:
 filmstrip(net3.dyn, displaylabels=F, mfrow=c(2, 3),
           slice.par=list(start=0, end=49, interval=10, 
                         aggregate.dur=10, rule=&#39;any&#39;))
 
# We can pre-compute the animation coordinates (otherwise they get calculated when 
# you generate the animation). Here &#39;animation.mode&#39; is the layout algorithm - 
# one of &quot;kamadakawai&quot;, &quot;MDSJ&quot;, &quot;Graphviz&quot;and &quot;useAttribute&quot; (user-generated).

# Here &#39;slice.par&#39; is a list of parameters controlling how the network visualization 
# moves through time. The parameter &#39;interval&#39; is the time step between layouts, 
# &#39;aggregate.dur&#39; is the period shown in each layout, &#39;rule&#39; is the rule for 
# displaying elements (e.g. &#39;any&#39;: active at any point during that period, 
# &#39;all&#39;: active during the entire period, etc.)
 

# Let&#39;s make an actual animation: 
 
compute.animation(net3.dyn, animation.mode = &quot;kamadakawai&quot;,
                  slice.par=list(start=0, end=50, interval=1, 
                         aggregate.dur=1, rule=&#39;any&#39;))


render.d3movie(net3.dyn, usearrows = F, 
               displaylabels = F, label=net3 %v% &quot;media&quot;,
               bg=&quot;#ffffff&quot;, vertex.border=&quot;#333333&quot;,
               vertex.cex = degree(net3)/2,  
               vertex.col = net3.dyn %v% &quot;col&quot;,
               edge.lwd = (net3.dyn %e% &quot;weight&quot;)/3, 
               edge.col = &#39;#55555599&#39;,
               vertex.tooltip = paste(&quot;&lt;b&gt;Name:&lt;/b&gt;&quot;, (net3.dyn %v% &quot;media&quot;) , &quot;&lt;br&gt;&quot;,
                                    &quot;&lt;b&gt;Type:&lt;/b&gt;&quot;, (net3.dyn %v% &quot;type.label&quot;) ),
               edge.tooltip = paste(&quot;&lt;b&gt;Edge type:&lt;/b&gt;&quot;, (net3.dyn %e% &quot;type&quot;), &quot;&lt;br&gt;&quot;, 
                                  &quot;&lt;b&gt;Edge weight:&lt;/b&gt;&quot;, (net3.dyn %e% &quot;weight&quot; ) ),
               launchBrowser=T, filename=&quot;Media-Network-Dynamic.html&quot;,
               render.par=list(tween.frames = 30, show.time = F),
               plot.par=list(mar=c(0,0,0,0)) )


# In addition to dynamic nodes and edges, &#39;ndtv&#39; takes dynamic attributes.
# We could have added those to the &#39;es&#39; and &#39;vs&#39; data frames above.
# However, the plotting function can also evaluate parameters
# and generate dynamic arguments on the fly. For example,
# function(slice) { do some calculations with slice } will perform operations
# on the current time slice network, letting us change parameters dynamically.

# See the node size below:

compute.animation(net3.dyn, animation.mode = &quot;kamadakawai&quot;,
                  slice.par=list(start=0, end=50, interval=4, 
                         aggregate.dur=1, rule=&#39;any&#39;))


render.d3movie(net3.dyn, usearrows = F, 
               displaylabels = F, label=net3 %v% &quot;media&quot;,
               bg=&quot;#000000&quot;, vertex.border=&quot;#dddddd&quot;,
               vertex.cex = function(slice){ degree(slice)/2.5 },  
               vertex.col = net3.dyn %v% &quot;col&quot;,
               edge.lwd = (net3.dyn %e% &quot;weight&quot;)/3, 
               edge.col = &#39;#55555599&#39;,
               vertex.tooltip = paste(&quot;&lt;b&gt;Name:&lt;/b&gt;&quot;, (net3.dyn %v% &quot;media&quot;) , &quot;&lt;br&gt;&quot;,
                                    &quot;&lt;b&gt;Type:&lt;/b&gt;&quot;, (net3.dyn %v% &quot;type.label&quot;) ),
               edge.tooltip = paste(&quot;&lt;b&gt;Edge type:&lt;/b&gt;&quot;, (net3.dyn %e% &quot;type&quot;), &quot;&lt;br&gt;&quot;, 
                                  &quot;&lt;b&gt;Edge weight:&lt;/b&gt;&quot;, (net3.dyn %e% &quot;weight&quot; ) ),
               launchBrowser=T, filename=&quot;Media-Network-even-more-Dynamic.html&quot;,
               render.par=list(tween.frames = 25, show.time = F) )


detach(&quot;package:ndtv&quot;)
detach(&quot;package:sna&quot;)
detach(&quot;package:networkDynamic&quot;)
detach(&quot;package:network&quot;)


# ================ 10. Plotting networks on a geographic map ================


# The example below plots a network on a map using base R and mapping libraries.

# Note that for those familiar with it, the package &#39;ggplot2&#39; may provide 
# a more flexible way of doing this. Things there work similarly to below,
# but you would use borders() to plot the map and geom_path() for the edges.


rm(list = ls()) # clear the workspace 


# In order to plot on a map, we&#39;ll need two additional packages.
# If you do not already have them, install those now:
# install.packages(&quot;maps&quot;)
# install.packages(&quot;geosphere&quot;)

library(&quot;maps&quot;)
library(&quot;geosphere&quot;)

# Package &#39;maps&#39; has built-in maps it can plot for you. For example:
# (&#39;col&#39; is map fill, &#39;border&#39; is  border color, &#39;bg&#39; is  background color)
par(mfrow = c(2,2))
map(&quot;usa&quot;, col=&quot;tomato&quot;,  border=&quot;gray10&quot;, fill=TRUE, bg=&quot;gray30&quot;)
map(&quot;state&quot;, col=&quot;orange&quot;,  border=&quot;gray10&quot;, fill=TRUE, bg=&quot;gray30&quot;)
map(&quot;county&quot;, col=&quot;palegreen&quot;,  border=&quot;gray10&quot;, fill=TRUE, bg=&quot;gray30&quot;)
map(&quot;world&quot;, col=&quot;skyblue&quot;,  border=&quot;gray10&quot;, fill=TRUE, bg=&quot;gray30&quot;)

dev.off()

# The data we will use contains US airports and flights among them. 
# The airport file includes info about latitude and longitude.
# If we did not have those, we could use &#39;geocode()&#39; from &#39;ggmap&#39;
# to get latitude and longitude for an address.

airports &lt;- read.csv(&quot;./Data Files/Dataset3-Airlines-NODES.csv&quot;, header=TRUE) 
flights &lt;- read.csv(&quot;./Data Files/Dataset3-Airlines-EDGES.csv&quot;, header=TRUE, as.is=TRUE)

head(flights)
head(airports)

# Select only large airports: ones with more than 10 connections in the data.
tab &lt;- table(flights$Source)
big.id &lt;- names(tab)[tab&gt;10]
airports &lt;- airports[airports$ID %in% big.id,]
flights  &lt;- flights[flights$Source %in% big.id &amp; 
                    flights$Target %in% big.id, ]


# Plot a map of the united states:
map(&quot;state&quot;, col=&quot;grey20&quot;, fill=TRUE, bg=&quot;black&quot;, lwd=0.1)

# Add a point on the map for each airport:
points(x=airports$longitude, y=airports$latitude, pch=19, 
       cex=airports$Visits/80, col=&quot;orange&quot;)

# Generate edge colors: lighter color means higher flight volume.
col.1 &lt;- adjustcolor(&quot;orange red&quot;, alpha=0.4)
col.2 &lt;- adjustcolor(&quot;orange&quot;, alpha=0.4)
edge.pal &lt;- colorRampPalette(c(col.1, col.2), alpha = TRUE)
edge.col &lt;- edge.pal(100)

# For each flight, we will generate the coordinates of an arc that connects
# its star and end point, using gcIntermediate() from package &#39;geosphere&#39;.
# Then we will plot that arc over the map using lines().
for(i in 1:nrow(flights))  {
    node1 &lt;- airports[airports$ID == flights[i,]$Source,]
    node2 &lt;- airports[airports$ID == flights[i,]$Target,]
    
    arc &lt;- gcIntermediate( c(node1[1,]$longitude, node1[1,]$latitude), 
                           c(node2[1,]$longitude, node2[1,]$latitude), 
                           n=1000, addStartEnd=TRUE )
    edge.ind &lt;- round(100*flights[i,]$Freq / max(flights$Freq))
    
    lines(arc, col=edge.col[edge.ind], lwd=edge.ind/30)
}



# ================ |-------------| ================
 


</code></pre>
<div id="reference-2" class="section level4">
<h4><span class="header-section-number">2.7.1.1</span> Reference</h4>
<p>Network visualization with R: <a href="http://www.kateto.net/polnet2018" class="uri">http://www.kateto.net/polnet2018</a></p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-of-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="correlation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
