<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Statistics notes for Bioinformation in R</title>
  <meta name="description" content="Statistics notes for Bioinformation in R">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Statistics notes for Bioinformation in R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Statistics notes for Bioinformation in R" />
  
  
  

<meta name="author" content="Shaojun Xie">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="mrg.html">
<link rel="next" href="plot-in-r.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="basic-systax.html"><a href="basic-systax.html"><i class="fa fa-check"></i><b>2</b> Basic systax</a><ul>
<li class="chapter" data-level="2.1" data-path="basic-systax.html"><a href="basic-systax.html#variale"><i class="fa fa-check"></i><b>2.1</b> Variale</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mrg.html"><a href="mrg.html"><i class="fa fa-check"></i><b>3</b> MRG</a><ul>
<li class="chapter" data-level="3.1" data-path="mrg.html"><a href="mrg.html#read-the-data"><i class="fa fa-check"></i><b>3.1</b> Read the data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>4</b> PCA</a><ul>
<li class="chapter" data-level="4.1" data-path="pca.html"><a href="pca.html#read-data"><i class="fa fa-check"></i><b>4.1</b> Read data</a></li>
<li class="chapter" data-level="4.2" data-path="pca.html"><a href="pca.html#head-data"><i class="fa fa-check"></i><b>4.2</b> Head data</a></li>
<li class="chapter" data-level="4.3" data-path="pca.html"><a href="pca.html#summary-of-the-data"><i class="fa fa-check"></i><b>4.3</b> Summary of the data</a></li>
<li class="chapter" data-level="4.4" data-path="pca.html"><a href="pca.html#check-the-distribution-of-the-data"><i class="fa fa-check"></i><b>4.4</b> Check the distribution of the data</a></li>
<li class="chapter" data-level="4.5" data-path="pca.html"><a href="pca.html#eigendecomposition---computing-eigenvectors-and-eigenvalues"><i class="fa fa-check"></i><b>4.5</b> Eigendecomposition - Computing Eigenvectors and Eigenvalues</a><ul>
<li class="chapter" data-level="4.5.1" data-path="pca.html"><a href="pca.html#covariance-matrix"><i class="fa fa-check"></i><b>4.5.1</b> Covariance Matrix</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="pca.html"><a href="pca.html#references"><i class="fa fa-check"></i><b>4.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="plot-in-r.html"><a href="plot-in-r.html"><i class="fa fa-check"></i><b>5</b> Plot in R</a><ul>
<li class="chapter" data-level="5.1" data-path="plot-in-r.html"><a href="plot-in-r.html#read-the-data-1"><i class="fa fa-check"></i><b>5.1</b> Read the data</a></li>
<li class="chapter" data-level="5.2" data-path="plot-in-r.html"><a href="plot-in-r.html#line-plot"><i class="fa fa-check"></i><b>5.2</b> Line plot</a></li>
<li class="chapter" data-level="5.3" data-path="plot-in-r.html"><a href="plot-in-r.html#basic-line-plot"><i class="fa fa-check"></i><b>5.3</b> Basic line plot</a></li>
<li class="chapter" data-level="5.4" data-path="plot-in-r.html"><a href="plot-in-r.html#color-the-dots-based-on-the-sex-information"><i class="fa fa-check"></i><b>5.4</b> Color the dots based on the <code>sex</code> information</a></li>
<li class="chapter" data-level="5.5" data-path="plot-in-r.html"><a href="plot-in-r.html#section"><i class="fa fa-check"></i><b>5.5</b> </a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html"><i class="fa fa-check"></i><b>6</b> Multiple linear regression</a><ul>
<li class="chapter" data-level="6.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#section-1"><i class="fa fa-check"></i><b>6.1</b> </a></li>
<li class="chapter" data-level="6.2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#section-2"><i class="fa fa-check"></i><b>6.2</b> </a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistics notes for Bioinformation in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pca" class="section level1">
<h1><span class="header-section-number">4</span> PCA</h1>
<div id="read-data" class="section level2">
<h2><span class="header-section-number">4.1</span> Read data</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris_tab &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;https://gist.githubusercontent.com/curran/a08a1080b88344b0c8a7/raw/d546eaee765268bf2f487608c537c05e22e4b221/iris.csv&quot;</span>)</code></pre></div>
</div>
<div id="head-data" class="section level2">
<h2><span class="header-section-number">4.2</span> Head data</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(iris_tab)</code></pre></div>
<pre><code>##   sepal_length sepal_width petal_length petal_width species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
</div>
<div id="summary-of-the-data" class="section level2">
<h2><span class="header-section-number">4.3</span> Summary of the data</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(iris_tab)</code></pre></div>
<pre><code>##   sepal_length    sepal_width     petal_length    petal_width   
##  Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
##  1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
##  Median :5.800   Median :3.000   Median :4.350   Median :1.300  
##  Mean   :5.843   Mean   :3.054   Mean   :3.759   Mean   :1.199  
##  3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
##  Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  
##        species  
##  setosa    :50  
##  versicolor:50  
##  virginica :50  
##                 
##                 
## </code></pre>
</div>
<div id="check-the-distribution-of-the-data" class="section level2">
<h2><span class="header-section-number">4.4</span> Check the distribution of the data</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(iris_tab<span class="op">$</span>sepal_length)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="eigendecomposition---computing-eigenvectors-and-eigenvalues" class="section level2">
<h2><span class="header-section-number">4.5</span> Eigendecomposition - Computing Eigenvectors and Eigenvalues</h2>
<p>The eigenvectors and eigenvalues of a covariance (or correlation) matrix represent the “core” of a PCA: The eigenvectors (principal components) determine the directions of the new feature space, and the eigenvalues determine their magnitude. In other words, the eigenvalues explain the variance of the data along the new feature axes.</p>
<div id="covariance-matrix" class="section level3">
<h3><span class="header-section-number">4.5.1</span> Covariance Matrix</h3>
<p>The classic approach to PCA is to perform the eigendecomposition on the covariance matrix <span class="math inline">\(\Sigma\)</span>, which is a <span class="math inline">\(d \times d\)</span> matrix where each element represents the covariance between two features. The covariance between two features is calculated as follows:</p>
<p><span class="math inline">\(\sigma_{jk} = \frac{1}{n-1}\sum_{i=1}^{N}\left( x_{ij}-\bar{x}_j \right) \left( x_{ik}-\bar{x}_k \right).\)</span></p>
<p>We can summarize the calculation of the covariance matrix via the following matrix equation:</p>
<p><span class="math inline">\(\Sigma = \frac{1}{n-1} \left( (\mathbf{X} - \mathbf{\bar{x}})^T\;(\mathbf{X} - \mathbf{\bar{x}}) \right)\)</span><br />
where <span class="math inline">\(\mathbf{\bar{x}}\)</span> is the mean vector <span class="math inline">\(\mathbf{\bar{x}} = \sum\limits_{i=1}^n x_{i}.\)</span></p>
<p>The mean vector is a <span class="math inline">\(d\)</span>-dimensional vector where each value in this vector represents the sample mean of a feature column in the dataset.</p>
<p>```</p>
</div>
</div>
<div id="references" class="section level2">
<h2><span class="header-section-number">4.6</span> References</h2>
<p><a href="https://sebastianraschka.com/Articles/2015_pca_in_3_steps.html#about-iris" class="uri">https://sebastianraschka.com/Articles/2015_pca_in_3_steps.html#about-iris</a></p>
<p>How to read PCA biplots and scree plots: <a href="https://blog.bioturing.com/2018/06/18/how-to-read-pca-biplots-and-scree-plots/" class="uri">https://blog.bioturing.com/2018/06/18/how-to-read-pca-biplots-and-scree-plots/</a></p>
<p>Principal Component Analysis (PCA): <a href="https://learnche.org/pid/latent-variable-modelling/principal-component-analysis/index" class="uri">https://learnche.org/pid/latent-variable-modelling/principal-component-analysis/index</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mrg.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="plot-in-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
