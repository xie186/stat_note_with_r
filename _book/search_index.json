[
["index.html", "Statistics notes for Bioinformatics in R 1 Preface", " Statistics notes for Bioinformatics in R Shaojun Xie 1 Preface This book includes the notes I have during the using of R as a Bioinformatician. "],
["basic-systax.html", "2 Basic systax 2.1 Setup 2.2 Data type 2.3 Data structures 2.4 Read from and write into files 2.5 Functions 2.6 Control structure", " 2 Basic systax 2.1 Setup 2.1.1 Install packages 2.1.2 Install 2.1.2.1 Getting help on functions and packages 2.2 Data type 2.3 Data structures R has multiple data structures. If you are familiar with excel you can think of data structures as building blocks of a table and the table itself, and a table is similar to a sheet in excel. Most of the time you will deal with tabular data sets, you will manipulate them, take sub-sections of them. It is essential to know what are the common data structures in R and how they can be used. R deals with named data structures, this means you can give names to data structures and manipulate or operate on them using those names. 2.4 Read from and write into files 2.5 Functions 2.6 Control structure library(datasets) data(iris) head(iris) ## Sepal.Length Sepal.Width Petal.Length Petal.Width Species ## 1 5.1 3.5 1.4 0.2 setosa ## 2 4.9 3.0 1.4 0.2 setosa ## 3 4.7 3.2 1.3 0.2 setosa ## 4 4.6 3.1 1.5 0.2 setosa ## 5 5.0 3.6 1.4 0.2 setosa ## 6 5.4 3.9 1.7 0.4 setosa summary(iris) ## Sepal.Length Sepal.Width Petal.Length Petal.Width ## Min. :4.300 Min. :2.000 Min. :1.000 Min. :0.100 ## 1st Qu.:5.100 1st Qu.:2.800 1st Qu.:1.600 1st Qu.:0.300 ## Median :5.800 Median :3.000 Median :4.350 Median :1.300 ## Mean :5.843 Mean :3.057 Mean :3.758 Mean :1.199 ## 3rd Qu.:6.400 3rd Qu.:3.300 3rd Qu.:5.100 3rd Qu.:1.800 ## Max. :7.900 Max. :4.400 Max. :6.900 Max. :2.500 ## Species ## setosa :50 ## versicolor:50 ## virginica :50 ## ## ## library(&quot;PerformanceAnalytics&quot;) ## Loading required package: xts ## Loading required package: zoo ## ## Attaching package: &#39;zoo&#39; ## The following objects are masked from &#39;package:base&#39;: ## ## as.Date, as.Date.numeric ## ## Attaching package: &#39;PerformanceAnalytics&#39; ## The following object is masked from &#39;package:graphics&#39;: ## ## legend chart.Correlation(iris[, 1:4], histogram=TRUE, pch=19) "],
["multiple-linear-regression.html", "3 Multiple linear regression 3.1 3.2 ", " 3 Multiple linear regression 3.1 Descriptions of the data: https://stat.ethz.ch/R-manual/R-patched/library/datasets/html/airquality.html Daily air quality measurements in New York, May to September 1973. data(&quot;airquality&quot;) names(airquality) ## [1] &quot;Ozone&quot; &quot;Solar.R&quot; &quot;Wind&quot; &quot;Temp&quot; &quot;Month&quot; &quot;Day&quot; require(graphics) pairs(airquality, panel = panel.smooth, main = &quot;airquality data&quot;) A formula of the form y ~ x | a indicates that plots of y versus x should be produced conditional on the variable a. A formula of the form y ~ x| a * b indicates that plots of y versus x should be produced conditional on the two variables a and b coplot(Ozone~Solar.R|Wind, panel = panel.smooth, airquality) ## ## Missing rows: 5, 6, 10, 11, 25, 26, 27, 32, 33, 34, 35, 36, 37, 39, 42, 43, 45, 46, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 65, 72, 75, 83, 84, 96, 97, 98, 102, 103, 107, 115, 119, 150 model2 = lm(Ozone~Solar.R*Wind, airquality) par(mfrow=c(2,2)) # Change the panel layout to 2 x 2 plot(model2) par(mfrow=c(1,1)) # Change back to 1 x 1 Residuals vs Fitted This plot shows if residuals have non-linear patterns. There could be a non-linear relationship between predictor variables and an outcome variable and the pattern could show up in this plot if the model doesn’t capture the non-linear relationship. If you find equally spread residuals around a horizontal line without distinct patterns, that is a good indication you don’t have non-linear relationships. Normal Q-Q This plot shows if residuals are normally distributed. Do residuals follow a straight line well or do they deviate severely? It’s good if residuals are lined well on the straight dashed line. Scale-Location It’s also called Spread-Location plot. This plot shows if residuals are spread equally along the ranges of predictors. This is how you can check the assumption of equal variance (homoscedasticity). It’s good if you see a horizontal line with equally (randomly) spread points. Residuals vs Leverage This plot helps us to find influential cases (i.e., subjects) if any. Not all outliers are influential in linear regression analysis (whatever outliers mean). Even though data have extreme values, they might not be influential to determine a regression line. That means, the results wouldn’t be much different if we either include or exclude them from analysis. They follow the trend in the majority of cases and they don’t really matter; they are not influential. On the other hand, some cases could be very influential even if they look to be within a reasonable range of the values. They could be extreme cases against a regression line and can alter the results if we exclude them from analysis. Another way to put it is that they don’t get along with the trend in the majority of the cases. Unlike the other plots, this time patterns are not relevant. We watch out for outlying values at the upper right corner or at the lower right corner. Those spots are the places where cases can be influential against a regression line. Look for cases outside of a dashed line, Cook’s distance. When cases are outside of the Cook’s distance (meaning they have high Cook’s distance scores), the cases are influential to the regression results. The regression results will be altered if we exclude those cases. #install.packages(&quot;UsingR&quot;) suppressWarnings(suppressMessages(library(UsingR))) data(father.son) names(father.son) ## [1] &quot;fheight&quot; &quot;sheight&quot; model_fs = lm(fheight~sheight, father.son) par(mfrow=c(2,2)) # Change the panel layout to 2 x 2 plot(model_fs) 3.2 summary(model2) ## ## Call: ## lm(formula = Ozone ~ Solar.R * Wind, data = airquality) ## ## Residuals: ## Min 1Q Median 3Q Max ## -48.694 -17.200 -4.384 12.740 78.218 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 34.467686 17.634602 1.955 0.053246 . ## Solar.R 0.324141 0.083928 3.862 0.000193 *** ## Wind -1.594546 1.508979 -1.057 0.293026 ## Solar.R:Wind -0.020279 0.007246 -2.799 0.006089 ** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 24.16 on 107 degrees of freedom ## (42 observations deleted due to missingness) ## Multiple R-squared: 0.487, Adjusted R-squared: 0.4727 ## F-statistic: 33.86 on 3 and 107 DF, p-value: 1.807e-15 par(mfrow=c(1,2)) # Change back to 1 x 1 termplot(model2, partial.resid=TRUE, col.res = &quot;royalblue&quot;) ## Warning in termplot(model2, partial.resid = TRUE, col.res = &quot;royalblue&quot;): ## &#39;model&#39; appears to involve interactions: see the help page summary(airquality$Solar.R) ## Min. 1st Qu. Median Mean 3rd Qu. Max. NA&#39;s ## 7.0 115.8 205.0 185.9 258.8 334.0 7 summary(airquality$Wind) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 1.700 7.400 9.700 9.958 11.500 20.700 Solar1 = mean(airquality$Solar.R, na.rm=T) Solar2 = 100 Solar3 = 300 p1 = predict(model2, data.frame(Solar.R=Solar1, Wind=1:20)) p2 = predict(model2, data.frame(Solar.R=Solar2, Wind=1:20)) p3 = predict(model2, data.frame(Solar.R=Solar3, Wind=1:20)) p1 ## 1 2 3 4 5 6 ## 89.370627 84.005541 78.640456 73.275370 67.910285 62.545199 ## 7 8 9 10 11 12 ## 57.180113 51.815028 46.449942 41.084856 35.719771 30.354685 ## 13 14 15 16 17 18 ## 24.989600 19.624514 14.259428 8.894343 3.529257 -1.835829 ## 19 20 ## -7.200914 -12.566000 plot(Ozone~Wind, airquality, col=&quot;grey&quot;) lines(p1, col=&quot;red&quot;) lines(p2, col=&quot;blue&quot;) lines(p3, col=&quot;darkgreen&quot;) "],
["references-and-resouces.html", "4 References and Resouces", " 4 References and Resouces "],
["references.html", "References", " References "],
["mrg.html", "5 MRG 5.1 Read the data", " 5 MRG Sir Francis Galton (1822–1911) was an English statistician. He founded many concepts in statistics, such as correlation, quartile, percentile and regression, that are still being used today. 5.1 Read the data Consider the data collected by Francis Galton in the 1880s, stored in a modern format in the galton.csv file. In this file, heights is the variable containing the child’s heights, while the father’s and mother’s height is contained in the variables father and mother. The family variable is a numerical code identifying children in the same family; the number of kids in this family is in nkids. ## Data from https://github.com/thomas-haslwanter/statsintro_python/blob/master/ISP/Code_Quantlets/08_TestsMeanValues/anovaOneway/galton.csv tab&lt;-read.csv(&quot;data/galton.csv&quot;) head(tab) ## family father mother sex height nkids ## 1 1 78.5 67.0 M 73.2 4 ## 2 1 78.5 67.0 F 69.2 4 ## 3 1 78.5 67.0 F 69.0 4 ## 4 1 78.5 67.0 F 69.0 4 ## 5 2 75.5 66.5 M 73.5 4 ## 6 2 75.5 66.5 M 72.5 4 Check the number of rows and columns: dim(tab) ## [1] 898 6 Covert the column of sex into numberic values: tab$sex=as.numeric(tab$sex) -1 head(tab) ## family father mother sex height nkids ## 1 1 78.5 67.0 1 73.2 4 ## 2 1 78.5 67.0 0 69.2 4 ## 3 1 78.5 67.0 0 69.0 4 ## 4 1 78.5 67.0 0 69.0 4 ## 5 2 75.5 66.5 1 73.5 4 ## 6 2 75.5 66.5 1 72.5 4 Remove the columns of nkids: tab&lt;-tab[, -c(6)] head(tab) ## family father mother sex height ## 1 1 78.5 67.0 1 73.2 ## 2 1 78.5 67.0 0 69.2 ## 3 1 78.5 67.0 0 69.0 ## 4 1 78.5 67.0 0 69.0 ## 5 2 75.5 66.5 1 73.5 ## 6 2 75.5 66.5 1 72.5 "],
["pca.html", "6 PCA 6.1 Read data 6.2 Head data 6.3 Summary of the data 6.4 Check the distribution of the data 6.5 Eigendecomposition - Computing Eigenvectors and Eigenvalues 6.6 References", " 6 PCA 6.1 Read data iris_tab &lt;- read.csv(&quot;https://gist.githubusercontent.com/curran/a08a1080b88344b0c8a7/raw/d546eaee765268bf2f487608c537c05e22e4b221/iris.csv&quot;) 6.2 Head data head(iris_tab) ## sepal_length sepal_width petal_length petal_width species ## 1 5.1 3.5 1.4 0.2 setosa ## 2 4.9 3.0 1.4 0.2 setosa ## 3 4.7 3.2 1.3 0.2 setosa ## 4 4.6 3.1 1.5 0.2 setosa ## 5 5.0 3.6 1.4 0.2 setosa ## 6 5.4 3.9 1.7 0.4 setosa 6.3 Summary of the data summary(iris_tab) ## sepal_length sepal_width petal_length petal_width ## Min. :4.300 Min. :2.000 Min. :1.000 Min. :0.100 ## 1st Qu.:5.100 1st Qu.:2.800 1st Qu.:1.600 1st Qu.:0.300 ## Median :5.800 Median :3.000 Median :4.350 Median :1.300 ## Mean :5.843 Mean :3.054 Mean :3.759 Mean :1.199 ## 3rd Qu.:6.400 3rd Qu.:3.300 3rd Qu.:5.100 3rd Qu.:1.800 ## Max. :7.900 Max. :4.400 Max. :6.900 Max. :2.500 ## species ## setosa :50 ## versicolor:50 ## virginica :50 ## ## ## 6.4 Check the distribution of the data hist(iris_tab$sepal_length) 6.5 Eigendecomposition - Computing Eigenvectors and Eigenvalues In linear algebra, an eigenvector is a non-zero vector that changes by only a scalar factor when that linear transformation is applied to it. The eigenvectors and eigenvalues of a covariance (or correlation) matrix represent the “core” of a PCA: The eigenvectors (principal components) determine the directions of the new feature space, and the eigenvalues determine their magnitude. In other words, the eigenvalues explain the variance of the data along the new feature axes. 6.5.1 Covariance Matrix The classic approach to PCA is to perform the eigendecomposition on the covariance matrix \\(\\Sigma\\), which is a \\(d \\times d\\) matrix where each element represents the covariance between two features. The covariance between two features is calculated as follows: \\(\\sigma_{jk} = \\frac{1}{n-1}\\sum_{i=1}^{N}\\left( x_{ij}-\\bar{x}_j \\right) \\left( x_{ik}-\\bar{x}_k \\right).\\) We can summarize the calculation of the covariance matrix via the following matrix equation: \\(\\Sigma = \\frac{1}{n-1} \\left( (\\mathbf{X} - \\mathbf{\\bar{x}})^T\\;(\\mathbf{X} - \\mathbf{\\bar{x}}) \\right)\\) where \\(\\mathbf{\\bar{x}}\\) is the mean vector \\(\\mathbf{\\bar{x}} = \\sum\\limits_{i=1}^n x_{i}.\\) The mean vector is a \\(d\\)-dimensional vector where each value in this vector represents the sample mean of a feature column in the dataset. cov_mat&lt;-cor(iris_tab[,1:4]) cov_mat ## sepal_length sepal_width petal_length petal_width ## sepal_length 1.0000000 -0.1093692 0.8717542 0.8179536 ## sepal_width -0.1093692 1.0000000 -0.4205161 -0.3565441 ## petal_length 0.8717542 -0.4205161 1.0000000 0.9627571 ## petal_width 0.8179536 -0.3565441 0.9627571 1.0000000 Next, we perform an eigendecomposition on the covariance matrix: eigen(cov_mat) ## eigen() decomposition ## $values ## [1] 2.91081808 0.92122093 0.14735328 0.02060771 ## ## $vectors ## [,1] [,2] [,3] [,4] ## [1,] 0.5223716 -0.37231836 0.7210168 0.2619956 ## [2,] -0.2633549 -0.92555649 -0.2420329 -0.1241348 ## [3,] 0.5812540 -0.02109478 -0.1408923 -0.8011543 ## [4,] 0.5656110 -0.06541577 -0.6338014 0.5235463 6.6 References https://sebastianraschka.com/Articles/2015_pca_in_3_steps.html#about-iris How to read PCA biplots and scree plots: https://blog.bioturing.com/2018/06/18/how-to-read-pca-biplots-and-scree-plots/ Principal Component Analysis (PCA): https://learnche.org/pid/latent-variable-modelling/principal-component-analysis/index "],
["plot-in-r.html", "7 Plot in R 7.1 Read the data 7.2 Line plot 7.3 Basic line plot 7.4 Color the dots based on the sex information 7.5 7.6 Draw a circle in R", " 7 Plot in R 7.1 Read the data Consider the data collected by Francis Galton in the 1880s, stored in a modern format in the galton.csv file. In this file, heights is the variable containing the child’s heights, while the father’s and mother’s height is contained in the variables father and mother. The family variable is a numerical code identifying children in the same family; the number of kids in this family is in nkids. ## Data from https://github.com/thomas-haslwanter/statsintro_python/blob/master/ISP/Code_Quantlets/08_TestsMeanValues/anovaOneway/galton.csv tab&lt;-read.csv(&quot;data/galton.csv&quot;) head(tab) ## family father mother sex height nkids ## 1 1 78.5 67.0 M 73.2 4 ## 2 1 78.5 67.0 F 69.2 4 ## 3 1 78.5 67.0 F 69.0 4 ## 4 1 78.5 67.0 F 69.0 4 ## 5 2 75.5 66.5 M 73.5 4 ## 6 2 75.5 66.5 M 72.5 4 7.2 Line plot 7.3 Basic line plot plot(tab$father, tab$height) 7.4 Color the dots based on the sex information col_info = ifelse(tab$sex==&quot;M&quot;, &quot;royalblue&quot;, &quot;darkred&quot;) plot(tab$father, tab$height, col=col_info) col_info = ifelse(tab$sex==&quot;M&quot;, &quot;royalblue&quot;, &quot;darkred&quot;) plot(tab$father, tab$height, col=col_info, xlim=c(60, 80), ylim=c(60, 80)) legend(76, 65,pch=c(19,19),col=c(&quot;royalblue&quot;, &quot;darkred&quot;),c(&quot;female&quot;, &quot;male&quot;),bty=&quot;o&quot;,cex=.8) 7.5 meth_lev=read.table(&quot;data/global_meth_lev.tsv&quot;, header=TRUE) meth_lev ## Sample CG CHG CHH ## 1 cmt23 0.227 0.009 0.011 ## 2 cmt2-3 0.229 0.062 0.010 ## 3 drm12cmt23 0.221 0.004 0.005 ## 4 drm12cmt2 0.222 0.059 0.005 ## 5 WT 0.247 0.079 0.029 7.6 Draw a circle in R # initialize a plot plot(c(-1, 1), c(-1, 1), type = &quot;n&quot;) # prepare &quot;circle data&quot; radius &lt;- 1 theta &lt;- seq(0, 2 * pi, length = 200) # draw the circle lines(x = radius * cos(theta), y = radius * sin(theta)) "]
]
